import{c as D,j as e,u as O,a as S,aj as P,O as w,r as o,B as r,T as a,C as y,b as x,a0 as g,S as p}from"./index-DVLSGWYZ.js";import{o as W}from"./orderApi-CXIEp2WA.js";import{A as b}from"./Alert-DeMLxQ5q.js";import{C as A,a as L}from"./CardContent-DCJIVk1m.js";import{O as B}from"./Receipt-3j3phCe3.js";const F=D(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),R=i=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(i);function N(){O();const i=S(),h=P(),[u]=w(),c=u.get("order_id"),d=h.state?.orderId,t=c||d,[n,I]=o.useState(null),[v,l]=o.useState(!0),[f,m]=o.useState(null),k=async()=>{if(console.log("PaymentSuccessPage - Order ID Debug:",{orderIdFromUrl:c,orderIdFromState:d,finalOrderId:t,locationState:h.state,searchParams:Object.fromEntries(u.entries())}),!t){m("Order ID tidak ditemukan dalam URL atau state"),l(!1);return}try{l(!0),console.log("Fetching order with ID:",t);const s=await W.getOrderById(t);s.success?I(s.data):m("Order tidak ditemukan di server")}catch(s){console.error("Error fetching order:",s),m(s.response?.data?.error||"Gagal memuat order")}finally{l(!1)}};o.useEffect(()=>{k()},[t]);const C=()=>{t&&i(`/orders/${t}`)},j=()=>{i("/")};return v?e.jsx(r,{sx:{minHeight:"100vh",py:8,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(a,{children:"Memuat..."})}):f||!n?e.jsx(r,{sx:{minHeight:"100vh",py:8},children:e.jsxs(y,{maxWidth:"md",children:[e.jsx(b,{severity:"error",sx:{maxWidth:600,mx:"auto"},children:f||"Order tidak ditemukan"}),e.jsx(r,{sx:{mt:2,p:2,backgroundColor:"#f5f5f5",borderRadius:1},children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Debug Info:"}),e.jsx("br",{}),"Order ID from URL: ",c||"null",e.jsx("br",{}),"Order ID from State: ",d||"null",e.jsx("br",{}),"Final Order ID: ",t||"null"]})}),e.jsx(r,{sx:{textAlign:"center",mt:4},children:e.jsx(x,{variant:"contained",onClick:j,startIcon:e.jsx(g,{}),children:"Kembali ke Beranda"})})]})}):e.jsx(r,{sx:{minHeight:"100vh",py:8},children:e.jsxs(y,{maxWidth:"md",children:[e.jsxs(r,{sx:{textAlign:"center",mb:6},children:[e.jsx(F,{sx:{fontSize:80,color:"success.main",mb:3,animation:"pulse 2s infinite","@keyframes pulse":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(1.05)"},"100%":{transform:"scale(1)"}}}}),e.jsx(a,{variant:"h3",fontWeight:700,color:"success.main",sx:{mb:2},children:"Pembayaran Berhasil!"}),e.jsx(a,{variant:"h6",color:"text.secondary",children:"Terima kasih atas pembelian Anda. Pesanan Anda sedang diproses."})]}),e.jsx(A,{sx:{mb:4},children:e.jsxs(L,{sx:{p:4},children:[e.jsx(a,{variant:"h6",fontWeight:600,sx:{mb:3},children:"Detail Pesanan"}),e.jsxs(p,{spacing:2,children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Order ID:"}),e.jsx(a,{variant:"body1",fontWeight:500,children:n.id})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Total Pembayaran:"}),e.jsx(a,{variant:"h6",fontWeight:600,color:"primary.main",children:R(Number(n.total_amount)+Number(n.shipping_cost))})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Status:"}),e.jsx(a,{variant:"body1",fontWeight:500,color:n.payment_status==="paid"?"success.main":"warning.main",children:n.payment_status==="paid"?"Lunas":n.payment_status})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Tanggal Pesanan:"}),e.jsx(a,{variant:"body1",fontWeight:500,children:new Date(n.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})}),e.jsx(b,{severity:"info",sx:{mb:4},children:e.jsx(a,{variant:"body2",children:'Kami akan mengirimkan email konfirmasi dan detail pengiriman ke alamat email Anda. Anda juga dapat melacak status pesanan di halaman "Pesanan Saya".'})}),e.jsxs(p,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"center",children:[e.jsx(x,{variant:"contained",size:"large",startIcon:e.jsx(B,{}),onClick:C,sx:{px:4,py:1.5,borderRadius:2,fontWeight:600},children:"Lihat Detail Pesanan"}),e.jsx(x,{variant:"outlined",size:"large",startIcon:e.jsx(g,{}),onClick:j,sx:{px:4,py:1.5,borderRadius:2,fontWeight:600},children:"Kembali ke Beranda"})]})]})})}export{N as default};
