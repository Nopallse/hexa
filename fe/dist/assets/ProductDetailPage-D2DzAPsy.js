import{c as ht,j as t,p as ut,a8 as xt,q as gt,r as d,a9 as bt,J as jt,B as a,C as E,aa as vt,t as z,T as n,w as p,M as f,ab as yt,ac as ft,D as _t,S as Z,ad as kt,I as tt,ae as g}from"./index-CLjvjqZT.js";import{p as Ct}from"./productApi-BX8HyBv8.js";import{a as S}from"./image-CeHRN-zl.js";import{u as St}from"./useCurrencyConversion-DcYLh6Vv.js";import{S as v}from"./Skeleton-BN8PhGVI.js";import{A as rt}from"./Alert-Cs6zeJMp.js";import{A as wt}from"./ArrowBack-DbsPIT4g.js";import{C as w,a as W}from"./CardContent-Dqpv-NXF.js";import{A as L}from"./Avatar-B6RLlSql.js";import{F as Wt}from"./Favorite-BvKrsvEC.js";import"./useSlot-CDkgSjON.js";const $t=ht(t.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92"}),"Share");function Dt(){const h=ut(),{id:b}=xt(),M=gt(),{formatPrice:m,formatPriceRange:R}=St(),[r,et]=d.useState(null),[at,G]=d.useState(!0),[U,$]=d.useState(null),[j,u]=d.useState(null),[It,Pt]=d.useState(0),[N,D]=d.useState(1),[s,I]=d.useState(null),[O,P]=d.useState({}),[F,T]=d.useState(!1),{addItem:it,isLoading:Tt,error:At}=bt(),{user:ot}=jt(),nt=async()=>{if(b)try{G(!0),$(null);const e=await Ct.getProductById(b);e.success?et(e.data):$("Produk tidak ditemukan")}catch(e){console.error("Error fetching product:",e),$("Gagal memuat produk")}finally{G(!1)}},st=async()=>{if(!r||!ot){M("/login");return}const e=r.product_variants&&r.product_variants.length>0;if(e&&r.product_variants&&r.product_variants.length>1&&!s){g.error("Pilih varian terlebih dahulu",{duration:3e3,position:"bottom-right"});return}try{T(!0);let i;if(e&&r.product_variants)if(r.product_variants.length===1)i=r.product_variants[0].id;else{if(!s){T(!1),g.error("Pilih varian terlebih dahulu",{duration:3e3,position:"bottom-right"});return}i=s.id}else i=r.id;await it({product_variant_id:i,quantity:N}),g.success("Item berhasil ditambahkan ke keranjang!",{duration:3e3,position:"bottom-right",icon:"ðŸ›’"}),D(1)}catch(i){console.error("Error adding to cart:",i),g.error(i.response?.data?.error||"Gagal menambahkan item ke keranjang",{duration:4e3,position:"bottom-right"})}finally{T(!1)}},ct=()=>{r&&console.log("Add to wishlist:",r)},lt=async()=>{if(!r||!b)return;const e=`${window.location.origin}/products/${b}`;let i="";if(r.product_variants&&r.product_variants.length>0)if(r.product_variants.length===1)i=m(Number(r.product_variants[0].price));else{const C=r.product_variants.map(pt=>Number(pt.price)),V=Math.min(...C),Y=Math.max(...C);V===Y?i=m(V):i=`${m(V)} - ${m(Y)}`}else i=m(Number(r.price));let o="";r.product_variants&&r.product_variants.length>1&&(o=`${r.product_variants.length} VARIAN`);const c=r.category?r.category.name.toUpperCase():"";let l=`Temukan ${r.name.toUpperCase()}`;o&&(l+=` ${o}`),c&&(l+=` ${c}`),l+=` seharga ${i}. Dapatkan sekarang juga di Hexa Crochet! ${e}`;const k=`${r.name} - Hexa Crochet`;if(navigator.share)try{await navigator.share({title:k,text:l,url:e}),g.success("Berhasil membagikan produk!",{duration:2e3,position:"bottom-right"})}catch(C){C.name!=="AbortError"&&await K(l)}else await K(l)},K=async e=>{try{await navigator.clipboard.writeText(e),g.success("Link produk berhasil disalin ke clipboard!",{duration:3e3,position:"bottom-right",icon:"ðŸ“‹"})}catch{const o=document.createElement("textarea");o.value=e,o.style.position="fixed",o.style.left="-999999px",o.style.top="-999999px",document.body.appendChild(o),o.focus(),o.select();try{document.execCommand("copy"),g.success("Link produk berhasil disalin ke clipboard!",{duration:3e3,position:"bottom-right",icon:"ðŸ“‹"})}catch{g.error("Gagal menyalin link. Silakan salin manual.",{duration:3e3,position:"bottom-right"})}finally{document.body.removeChild(o)}}};d.useEffect(()=>{if(r){const e=A(r);if(u(e?e.image_name:null),I(null),P({}),r.product_variants&&r.product_variants.length===1){const i=r.product_variants[0];I(i);const o={};i.variant_options?.forEach(c=>{o[c.option_name]=c.option_value}),P(o),i.image?u(i.image):i.display_image&&u(i.display_image)}}},[r]);const dt=()=>{if(!r?.product_variants)return{};const e={};return r.product_variants.forEach(i=>{i.variant_options?.forEach(o=>{e[o.option_name]||(e[o.option_name]=[]),e[o.option_name].includes(o.option_value)||e[o.option_name].push(o.option_value)})}),e},mt=(e,i)=>{const o={...O,[e]:i};P(o);const c=r?.product_variants?.find(l=>l.variant_options?.every(k=>o[k.option_name]===k.option_value));if(c){if(I(c),c.image)u(c.image);else if(c.display_image)u(c.display_image);else if(r){const l=A(r);u(l?l.image_name:null)}}},A=e=>e.product_images&&e.product_images.length>0?e.product_images.find(o=>o.is_primary)||e.product_images[0]:null;if(d.useEffect(()=>{nt()},[b]),at)return t.jsx(a,{sx:{minHeight:"100vh",py:4},children:t.jsxs(E,{maxWidth:!1,children:[t.jsx(v,{variant:"rectangular",height:400,sx:{mb:4,borderRadius:3}}),t.jsxs(a,{sx:{display:"flex",gap:4},children:[t.jsxs(a,{sx:{flex:1},children:[t.jsx(v,{variant:"text",height:48,sx:{mb:2}}),t.jsx(v,{variant:"text",height:24,sx:{mb:2}}),t.jsx(v,{variant:"text",height:32,sx:{mb:4}}),t.jsx(v,{variant:"rectangular",height:200})]}),t.jsx(a,{sx:{width:300},children:t.jsx(v,{variant:"rectangular",height:300,sx:{borderRadius:3}})})]})]})});if(U||!r)return t.jsx(a,{sx:{minHeight:"100vh",py:4},children:t.jsx(E,{maxWidth:!1,children:t.jsx(rt,{severity:"error",sx:{maxWidth:600,mx:"auto"},children:U||"Produk tidak ditemukan"})})});const x=r.product_variants&&r.product_variants.length>0,H=x&&r.product_variants&&r.product_variants.length>1,_=A(r),q=j||(_?_.image_name:null),J=dt(),B=x?r.product_variants.reduce((e,i)=>e+i.stock,0):r.stock,y=r?j?S(j):r.product_images&&r.product_images.length>0?S(r.product_images.find(e=>e.is_primary)?.image_name||r.product_images[0].image_name):`${window.location.origin}/images/product-placeholder.png`:"",Q=y&&!y.startsWith("http")?`${window.location.origin}${y.startsWith("/")?"":"/"}${y}`:y,X=r?r.product_variants&&r.product_variants.length>0?r.product_variants.length===1?m(Number(r.product_variants[0].price)):R(r.product_variants):m(Number(r.price)):"";return t.jsxs(a,{sx:{minHeight:"100vh",py:4},children:[r&&t.jsxs(vt,{children:[t.jsxs("title",{children:[r.name," - Hexa Crochet"]}),t.jsx("meta",{name:"description",content:r.description||`${r.name} - Produk berkualitas tinggi dari Hexa Crochet`}),t.jsx("meta",{property:"og:type",content:"product"}),t.jsx("meta",{property:"og:url",content:`${window.location.origin}/products/${b}`}),t.jsx("meta",{property:"og:title",content:`${r.name} - Hexa Crochet`}),t.jsx("meta",{property:"og:description",content:r.description||`${r.name} - Produk berkualitas tinggi dari Hexa Crochet. Harga: ${X}`}),t.jsx("meta",{property:"og:image",content:Q}),t.jsx("meta",{property:"og:image:width",content:"1200"}),t.jsx("meta",{property:"og:image:height",content:"630"}),t.jsx("meta",{property:"og:site_name",content:"Hexa Crochet"}),t.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),t.jsx("meta",{name:"twitter:url",content:`${window.location.origin}/products/${b}`}),t.jsx("meta",{name:"twitter:title",content:`${r.name} - Hexa Crochet`}),t.jsx("meta",{name:"twitter:description",content:r.description||`${r.name} - Produk berkualitas tinggi dari Hexa Crochet. Harga: ${X}`}),t.jsx("meta",{name:"twitter:image",content:Q}),t.jsx("meta",{property:"product:price:amount",content:r.product_variants&&r.product_variants.length>0?String(r.product_variants[0].price):String(r.price)}),t.jsx("meta",{property:"product:price:currency",content:"IDR"}),t.jsx("meta",{property:"product:availability",content:"in stock"}),t.jsx("meta",{property:"product:condition",content:"new"})]}),t.jsxs(E,{maxWidth:"xl",children:[t.jsx(z,{startIcon:t.jsx(wt,{}),onClick:()=>M(-1),sx:{mb:4},children:"Kembali"}),t.jsxs(a,{sx:{display:"flex",gap:3,flexWrap:"wrap"},children:[t.jsx(a,{sx:{flex:"1 1 300px",minWidth:300},children:t.jsx(w,{children:t.jsxs(W,{children:[t.jsx(n,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Galeri Gambar"}),q?t.jsx(a,{sx:{textAlign:"center",mb:2},children:t.jsx(L,{src:S(q),variant:"rounded",sx:{width:"100%",height:300,transition:"all 0.3s ease",boxShadow:2}})}):t.jsx(a,{sx:{textAlign:"center",mb:2},children:t.jsx(L,{variant:"rounded",sx:{width:"100%",height:300},children:r.name.charAt(0).toUpperCase()})}),r.product_images&&r.product_images.length>0?t.jsxs(a,{children:[t.jsxs(n,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:["Semua Gambar (",r.product_images.length,")"]}),t.jsx(a,{sx:{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"center"},children:r.product_images.sort((e,i)=>(i.is_primary?1:0)-(e.is_primary?1:0)).map(e=>t.jsxs(a,{sx:{position:"relative"},onMouseEnter:()=>u(e.image_name),onMouseLeave:()=>u(_?_.image_name:null),children:[t.jsx(L,{src:S(e.image_name),variant:"rounded",sx:{width:70,height:70,cursor:"pointer",border:j===e.image_name?3:2,borderColor:j===e.image_name?"primary.main":"divider",transition:"all 0.2s ease",opacity:j===e.image_name?1:.7,"&:hover":{opacity:1,transform:"scale(1.05)",borderColor:"primary.main"}}}),e.is_primary&&t.jsx(p,{label:"Utama",size:"small",color:"primary",sx:{position:"absolute",bottom:-8,left:"50%",transform:"translateX(-50%)",fontSize:"0.65rem",height:16,"& .MuiChip-label":{px:.5}}})]},e.id))})]}):t.jsx(rt,{severity:"info",sx:{mt:2},children:"Belum ada gambar produk"})]})})}),t.jsx(a,{sx:{flex:"2 1 500px",minWidth:500},children:t.jsx(w,{children:t.jsxs(W,{children:[t.jsxs(a,{sx:{mb:3},children:[t.jsx(n,{variant:"h5",fontWeight:"bold",gutterBottom:!0,children:r.name}),r.product_variants&&r.product_variants.length>0?t.jsxs(a,{children:[t.jsx(n,{variant:"h4",color:"primary",fontWeight:"bold",children:R(r.product_variants)}),t.jsxs(n,{variant:"body2",color:"textSecondary",children:["Total Stok: ",r.total_stock||0," unit"]})]}):t.jsx(n,{variant:"h4",color:"primary",fontWeight:"bold",children:m(Number(r.price))})]}),t.jsx(f,{sx:{mb:3}}),t.jsxs(a,{sx:{mb:3},children:[t.jsx(n,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Deskripsi"}),t.jsx(n,{variant:"body1",color:"textSecondary",children:r.description||"Tidak ada deskripsi"})]}),t.jsx(f,{sx:{mb:3}}),t.jsxs(a,{sx:{mb:3},children:[t.jsx(n,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Kategori"}),r.category?t.jsxs(a,{children:[t.jsx(p,{label:r.category.name,color:"primary",variant:"outlined",sx:{mb:1}}),r.category.description&&t.jsx(n,{variant:"body2",color:"textSecondary",children:r.category.description})]}):t.jsx(n,{variant:"body2",color:"textSecondary",children:"Tidak ada kategori"})]}),t.jsx(f,{sx:{mb:3}}),t.jsxs(a,{sx:{mb:3},children:[t.jsx(n,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Informasi Produksi"}),t.jsxs(a,{sx:{display:"flex",gap:2,flexWrap:"wrap",alignItems:"center"},children:[r.pre_order&&r.pre_order>0?t.jsx(p,{label:`Pre-order ${r.pre_order} hari`,color:"warning",variant:"filled",sx:{fontWeight:"bold"}}):t.jsx(p,{label:"Tersedia Langsung",color:"success",variant:"filled",sx:{fontWeight:"bold"}}),r.product_variants&&r.product_variants.length>0?t.jsx(p,{label:`Total Stok: ${r.total_stock||0} unit`,color:(r.total_stock||0)>0?"success":"error",variant:(r.total_stock||0)>0?"filled":"outlined"}):t.jsx(p,{label:`Stok: ${r.stock||0} unit`,color:(r.stock||0)>0?"success":"error",variant:(r.stock||0)>0?"filled":"outlined"})]}),t.jsx(n,{variant:"body2",color:"textSecondary",sx:{mt:1},children:r.pre_order&&r.pre_order>0?`Produk ini membutuhkan ${r.pre_order} hari untuk dibuat setelah order`:"Produk tersedia langsung dan siap dikirim"})]}),H&&Object.keys(J).length>0&&t.jsxs(yt.Fragment,{children:[t.jsx(f,{sx:{mb:3}}),t.jsxs(a,{sx:{mb:3},children:[t.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[t.jsx(n,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Pilih Varian"}),r.product_variants&&r.product_variants.length>0?t.jsx(p,{label:`${r.product_variants.length} Varian`,color:"primary",size:"small",variant:"filled",sx:{fontWeight:"bold",bgcolor:"primary.main",color:"white",border:"1px solid",borderColor:"primary.dark",letterSpacing:.5}}):t.jsx(p,{label:`Stok: ${r.stock||0}`,color:(r.stock||0)>0?"success":"error",size:"small",variant:(r.stock||0)>0?"filled":"outlined"})]}),Object.entries(J).map(([e,i])=>t.jsxs(a,{sx:{mb:2},children:[t.jsx(n,{variant:"subtitle2",fontWeight:"bold",gutterBottom:!0,children:e}),t.jsx(a,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:i.map(o=>{const c=O[e]===o;return t.jsxs(z,{variant:c?"contained":"outlined",onClick:()=>mt(e,o),size:"large",sx:{minWidth:80,borderWidth:2,borderColor:c?"primary.main":"divider",position:"relative",textTransform:"none","&:hover":{borderWidth:2,borderColor:"primary.main"}},children:[t.jsx(n,{variant:"body2",fontWeight:c?"bold":"medium",children:o}),c&&t.jsx(a,{sx:{position:"absolute",top:4,right:4,width:16,height:16,bgcolor:"white",color:"primary.main",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold"},children:"âœ“"})]},o)})})]},e)),s&&t.jsx(w,{variant:"outlined",sx:{mb:3,bgcolor:"primary.50",borderColor:"primary.main"},children:t.jsx(W,{children:t.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2},children:[t.jsxs(a,{children:[t.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Varian Terpilih"}),t.jsx(n,{variant:"h6",fontWeight:"bold",children:s.variant_name}),t.jsxs(n,{variant:"caption",color:"text.secondary",children:["SKU: ",s.sku]})]}),t.jsxs(a,{sx:{textAlign:"right"},children:[t.jsx(n,{variant:"h4",color:"primary.main",fontWeight:"bold",children:m(Number(s.price))}),t.jsx(p,{label:`Stok: ${s.stock} unit`,size:"small",color:s.stock>0?"success":"error",sx:{mt:.5}})]})]})})}),t.jsx(f,{sx:{mb:3}})]})]}),x&&r.product_variants&&r.product_variants.length===1&&s&&t.jsx(a,{sx:{mb:3},children:t.jsx(w,{variant:"outlined",sx:{bgcolor:"primary.50",borderColor:"primary.main"},children:t.jsx(W,{children:t.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2},children:[t.jsxs(a,{children:[t.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Varian Tersedia"}),t.jsx(n,{variant:"h6",fontWeight:"bold",children:s.variant_name}),t.jsxs(n,{variant:"caption",color:"text.secondary",children:["SKU: ",s.sku]})]}),t.jsxs(a,{sx:{textAlign:"right"},children:[t.jsx(n,{variant:"h4",color:"primary.main",fontWeight:"bold",children:m(Number(s.price))}),t.jsx(p,{label:`Stok: ${s.stock} unit`,size:"small",color:s.stock>0?"success":"error",sx:{mt:.5}})]})]})})})}),t.jsxs(a,{sx:{mb:4},children:[t.jsx(ft,{component:"legend",sx:{mb:1,fontWeight:600},children:"Jumlah:"}),t.jsx(_t,{type:"number",value:N,onChange:e=>D(Math.max(1,parseInt(e.target.value)||1)),inputProps:{min:1,max:x&&r.product_variants?r.product_variants.length===1?r.product_variants[0].stock||1:s&&s.stock||1:B},sx:{width:120},size:"small"})]}),t.jsxs(Z,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:4},children:[t.jsx(z,{variant:"contained",size:"large",startIcon:t.jsx(kt,{}),onClick:st,disabled:(B||0)===0||F||H&&!s||x&&s&&s.stock===0||x&&r.product_variants&&r.product_variants.length===1&&r.product_variants[0].stock===0,sx:{px:4,py:1.5,borderRadius:2,fontWeight:600,fontSize:"1rem",minHeight:48,flex:{xs:1,sm:"none"}},children:F?"Menambahkan...":(B||0)===0?"Stok Habis":H&&!s?"Pilih Varian":x&&s&&s.stock===0||x&&r.product_variants&&r.product_variants.length===1&&r.product_variants[0].stock===0?"Stok Habis":"Tambah ke Keranjang"}),t.jsxs(Z,{direction:"row",spacing:1,sx:{justifyContent:{xs:"center",sm:"flex-start"}},children:[t.jsx(tt,{onClick:ct,sx:{border:`1px solid ${h.palette.grey[300]}`,color:h.palette.primary.main,width:48,height:48,"&:hover":{backgroundColor:h.palette.primary.light+"20",borderColor:h.palette.primary.main}},children:t.jsx(Wt,{})}),t.jsx(tt,{onClick:lt,sx:{border:`1px solid ${h.palette.grey[300]}`,color:h.palette.primary.main,width:48,height:48,"&:hover":{backgroundColor:h.palette.primary.light+"20",borderColor:h.palette.primary.main}},children:t.jsx($t,{})})]})]})]})})})]})]})]})}export{Dt as default};
