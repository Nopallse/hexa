import{l as D,k as N,r as d,m as Q,_ as E,a1 as ue,a2 as xe,o as b,j as e,s as W,t as O,v as T,c as J,a3 as X,a4 as me,a5 as _,a6 as he,n as pe,a7 as fe,a8 as ge,u as B,T as s,B as l,S as k,R as ye,W as Y,D as $,b as z,Z as ee,a as re,F as ae,a9 as je,C as G,$ as L,a0 as be}from"./index-DVLSGWYZ.js";import{u as ve}from"./cartStore-DsEuM1fv.js";import{u as Ce}from"./orderStore-DcQPaBSr.js";import{o as q}from"./orderApi-CXIEp2WA.js";import{C as P,a as F}from"./CardContent-DCJIVk1m.js";import{a as ke}from"./addressApi-B6xq4cwq.js";import{S as Re}from"./Skeleton-KFRaNZZc.js";import{A}from"./Alert-DeMLxQ5q.js";import{A as H}from"./Add-0Q1eCPNm.js";import{S as Se,F as te}from"./FormControlLabel-BjLk7wiJ.js";import{B as Ie}from"./Breadcrumbs-CTwzKUk5.js";function we(r){return D("MuiFormGroup",r)}N("MuiFormGroup",["root","row","error"]);const Pe=["className","row"],Fe=r=>{const{classes:a,row:o,error:n}=r;return T({root:["root",o&&"row",n&&"error"]},we,a)},We=W("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(r,a)=>{const{ownerState:o}=r;return[a.root,o.row&&a.row]}})(({ownerState:r})=>b({display:"flex",flexDirection:"column",flexWrap:"wrap"},r.row&&{flexDirection:"row"})),Me=d.forwardRef(function(a,o){const n=Q({props:a,name:"MuiFormGroup"}),{className:t,row:m=!1}=n,h=E(n,Pe),p=ue(),c=xe({props:n,muiFormControl:p,states:["error"]}),u=b({},n,{row:m,error:c.error}),j=Fe(u);return e.jsx(We,b({className:O(j.root,t),ownerState:u,ref:o},h))}),_e=J(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),ze=J(e.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),Ae=W("span",{name:"MuiRadioButtonIcon",shouldForwardProp:X})({position:"relative",display:"flex"}),Be=W(_e,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),$e=W(ze,{name:"MuiRadioButtonIcon"})(({theme:r,ownerState:a})=>b({left:0,position:"absolute",transform:"scale(0)",transition:r.transitions.create("transform",{easing:r.transitions.easing.easeIn,duration:r.transitions.duration.shortest})},a.checked&&{transform:"scale(1)",transition:r.transitions.create("transform",{easing:r.transitions.easing.easeOut,duration:r.transitions.duration.shortest})}));function ne(r){const{checked:a=!1,classes:o={},fontSize:n}=r,t=b({},r,{checked:a});return e.jsxs(Ae,{className:o.root,ownerState:t,children:[e.jsx(Be,{fontSize:n,className:o.background,ownerState:t}),e.jsx($e,{fontSize:n,className:o.dot,ownerState:t})]})}const oe=d.createContext(void 0);function Ge(){return d.useContext(oe)}function De(r){return D("MuiRadio",r)}const V=N("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),Ne=["checked","checkedIcon","color","icon","name","onChange","size","className"],Ee=r=>{const{classes:a,color:o,size:n}=r,t={root:["root",`color${_(o)}`,n!=="medium"&&`size${_(n)}`]};return b({},a,T(t,De,a))},Oe=W(Se,{shouldForwardProp:r=>X(r)||r==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(r,a)=>{const{ownerState:o}=r;return[a.root,o.size!=="medium"&&a[`size${_(o.size)}`],a[`color${_(o.color)}`]]}})(({theme:r,ownerState:a})=>b({color:(r.vars||r).palette.text.secondary},!a.disableRipple&&{"&:hover":{backgroundColor:r.vars?`rgba(${a.color==="default"?r.vars.palette.action.activeChannel:r.vars.palette[a.color].mainChannel} / ${r.vars.palette.action.hoverOpacity})`:he.alpha(a.color==="default"?r.palette.action.active:r.palette[a.color].main,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},a.color!=="default"&&{[`&.${V.checked}`]:{color:(r.vars||r).palette[a.color].main}},{[`&.${V.disabled}`]:{color:(r.vars||r).palette.action.disabled}}));function Te(r,a){return typeof a=="object"&&a!==null?r===a:String(r)===String(a)}const K=e.jsx(ne,{checked:!0}),Z=e.jsx(ne,{}),se=d.forwardRef(function(a,o){var n,t;const m=Q({props:a,name:"MuiRadio"}),{checked:h,checkedIcon:p=K,color:c="primary",icon:u=Z,name:j,onChange:i,size:f="medium",className:y}=m,C=E(m,Ne),S=b({},m,{color:c,size:f}),R=Ee(S),v=Ge();let g=h;const I=me(i,v&&v.onChange);let w=j;return v&&(typeof g>"u"&&(g=Te(v.value,m.value)),typeof w>"u"&&(w=v.name)),e.jsx(Oe,b({type:"radio",icon:d.cloneElement(u,{fontSize:(n=Z.props.fontSize)!=null?n:f}),checkedIcon:d.cloneElement(p,{fontSize:(t=K.props.fontSize)!=null?t:f}),ownerState:S,classes:R,name:w,checked:g,onChange:I,ref:o,className:O(R.root,y)},C))});function Ue(r){return D("MuiRadioGroup",r)}N("MuiRadioGroup",["root","row","error"]);const Le=["actions","children","className","defaultValue","name","onChange","value"],qe=r=>{const{classes:a,row:o,error:n}=r;return T({root:["root",o&&"row",n&&"error"]},Ue,a)},ie=d.forwardRef(function(a,o){const{actions:n,children:t,className:m,defaultValue:h,name:p,onChange:c,value:u}=a,j=E(a,Le),i=d.useRef(null),f=qe(a),[y,C]=pe({controlled:u,default:h,name:"RadioGroup"});d.useImperativeHandle(n,()=>({focus:()=>{let g=i.current.querySelector("input:not(:disabled):checked");g||(g=i.current.querySelector("input:not(:disabled)")),g&&g.focus()}}),[]);const S=fe(o,i),R=ge(p),v=d.useMemo(()=>({name:R,onChange(g){C(g.target.value),c&&c(g,g.target.value)},value:y}),[R,c,C,y]);return e.jsx(oe.Provider,{value:v,children:e.jsx(Me,b({role:"radiogroup",ref:S,className:O(f.root,m)},j,{children:t}))})}),M=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r);function He({items:r,subtotal:a,shippingCost:o,total:n,onCreateOrder:t,creatingOrder:m,disabled:h}){const p=B();return e.jsx(P,{sx:{position:"sticky",top:24},children:e.jsxs(F,{children:[e.jsx(s,{variant:"h6",fontWeight:700,sx:{mb:3},children:"Ringkasan Pesanan"}),e.jsxs(l,{sx:{mb:3},children:[e.jsxs(s,{variant:"subtitle1",fontWeight:600,sx:{mb:2},children:["Item (",r.length,")"]}),e.jsx(k,{spacing:2,children:r.map(c=>{const u=c.product_variant.product.product_images?.[0]?.image_name;return e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,p:2,borderRadius:2,backgroundColor:"#f8f9fa",border:`1px solid ${p.palette.grey[200]}`},children:[e.jsx(ye,{src:u||`https://placehold.co/50x50/9682DB/FFFFFF/png?text=${encodeURIComponent(c.product_variant.product.name)}`,alt:c.product_variant.product.name,sx:{width:50,height:50,borderRadius:1.5,flexShrink:0},variant:"rounded",children:e.jsx(Y,{})}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(s,{variant:"subtitle2",fontWeight:600,sx:{mb:.5},children:c.product_variant.product.name}),e.jsx(s,{variant:"body2",color:"text.secondary",children:c.product_variant.variant_name}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["Qty: ",c.quantity]})]}),e.jsx(s,{variant:"body2",fontWeight:600,color:"primary.main",children:M(parseFloat(c.product_variant.price)*c.quantity)})]},c.id)})})]}),e.jsx($,{sx:{my:2}}),e.jsxs(k,{spacing:2,children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(s,{variant:"body1",children:"Subtotal"}),e.jsx(s,{variant:"body1",fontWeight:600,children:M(a)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(s,{variant:"body1",children:"Biaya Pengiriman"}),e.jsx(s,{variant:"body1",fontWeight:600,children:M(o)})]}),e.jsx($,{}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(s,{variant:"h6",fontWeight:700,children:"Total"}),e.jsx(s,{variant:"h6",fontWeight:700,color:"primary.main",children:M(n)})]})]}),e.jsx($,{sx:{my:3}}),e.jsx(z,{variant:"contained",size:"large",startIcon:e.jsx(ee,{}),onClick:t,disabled:h||m,fullWidth:!0,sx:{py:2,borderRadius:2,fontWeight:600,fontSize:"1.1rem",backgroundColor:"#003087","&:hover":{backgroundColor:"#002366"}},children:m?"Membuat Order...":"Buat Order & Bayar dengan PayPal"}),e.jsx(l,{sx:{mt:2,textAlign:"center"},children:e.jsx(s,{variant:"caption",color:"text.secondary",children:"Pembayaran aman dengan PayPal Payment Gateway"})}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mt:2,textAlign:"center"},children:"Dengan melanjutkan, Anda menyetujui syarat dan ketentuan kami"})]})})}function Ve({selectedAddress:r,onAddressSelect:a}){const o=B(),n=re(),[t,m]=d.useState([]),[h,p]=d.useState(!0),[c,u]=d.useState(null);d.useEffect(()=>{(async()=>{try{p(!0),u(null);const f=await ke.getAddresses();if(f.success){m(f.data);const y=f.data.find(C=>C.is_primary);y&&a(y.id)}else u("Gagal memuat alamat")}catch(f){console.error("Error fetching addresses:",f),u(f.response?.data?.error||"Gagal memuat alamat")}finally{p(!1)}})()},[a]);const j=()=>{n("/addresses/add",{state:{returnTo:"/checkout"}})};return h?e.jsx(P,{children:e.jsxs(F,{children:[e.jsx(s,{variant:"h6",fontWeight:600,sx:{mb:2},children:"Alamat Pengiriman"}),e.jsx(k,{spacing:2,children:[...Array(2)].map((i,f)=>e.jsx(Re,{variant:"rectangular",height:80,sx:{borderRadius:2}},f))})]})}):t.length===0?e.jsx(P,{children:e.jsxs(F,{children:[e.jsx(s,{variant:"h6",fontWeight:600,sx:{mb:2},children:"Alamat Pengiriman"}),e.jsx(A,{severity:"info",sx:{mb:2},children:"Anda belum memiliki alamat pengiriman. Silakan tambahkan alamat terlebih dahulu."}),e.jsx(z,{variant:"contained",startIcon:e.jsx(H,{}),onClick:j,fullWidth:!0,children:"Tambah Alamat"})]})}):e.jsx(P,{children:e.jsxs(F,{children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(s,{variant:"h6",fontWeight:600,children:"Alamat Pengiriman"}),e.jsx(z,{variant:"outlined",size:"small",startIcon:e.jsx(H,{}),onClick:j,children:"Tambah Alamat"})]}),c&&e.jsx(A,{severity:"error",sx:{mb:2},onClose:()=>u(null),children:c}),e.jsx(ae,{component:"fieldset",fullWidth:!0,children:e.jsx(ie,{value:r||"",onChange:i=>a(i.target.value),children:t.map(i=>e.jsx(te,{value:i.id,control:e.jsx(se,{}),label:e.jsx(l,{sx:{p:2,border:r===i.id?`2px solid ${o.palette.primary.main}`:`1px solid ${o.palette.grey[300]}`,borderRadius:2,backgroundColor:r===i.id?o.palette.primary.light+"10":"transparent",transition:"all 0.2s ease",width:"100%"},children:e.jsxs(k,{direction:"row",spacing:2,alignItems:"flex-start",children:[e.jsx(je,{color:"primary",sx:{mt:.5,flexShrink:0}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(s,{variant:"subtitle1",fontWeight:600,children:i.address_line}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:[i.city,", ",i.province," ",i.postal_code]}),i.is_primary&&e.jsx(l,{sx:{display:"inline-block",backgroundColor:o.palette.primary.main,color:"white",px:1,py:.5,borderRadius:1,fontSize:"0.75rem",fontWeight:600,mt:1},children:"Utama"})]})]})}),sx:{width:"100%",margin:0,"& .MuiFormControlLabel-label":{width:"100%"}}},i.id))})})]})})}function Ke({paymentMethods:r,selectedMethod:a,onMethodSelect:o}){const n=B();return e.jsx(P,{children:e.jsxs(F,{children:[e.jsx(s,{variant:"h6",fontWeight:600,sx:{mb:2},children:"Metode Pembayaran"}),e.jsx(ae,{component:"fieldset",fullWidth:!0,children:e.jsx(ie,{value:a||"",onChange:t=>o(t.target.value),children:r.map(t=>e.jsx(te,{value:t.id,control:e.jsx(se,{}),disabled:!t.available,label:e.jsx(l,{sx:{p:2,border:a===t.id?`2px solid ${n.palette.primary.main}`:`1px solid ${n.palette.grey[300]}`,borderRadius:2,backgroundColor:a===t.id?n.palette.primary.light+"10":"transparent",opacity:t.available?1:.5,transition:"all 0.2s ease",width:"100%"},children:e.jsxs(k,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(s,{variant:"h5",sx:{fontSize:"2rem",flexShrink:0,filter:t.available?"none":"grayscale(100%)"},children:t.icon}),e.jsxs(l,{sx:{flex:1},children:[e.jsxs(k,{direction:"row",alignItems:"center",spacing:1,sx:{mb:.5},children:[e.jsx(s,{variant:"subtitle1",fontWeight:600,children:t.name}),t.requires_approval&&e.jsx(l,{sx:{backgroundColor:n.palette.warning.main,color:"white",px:1,py:.25,borderRadius:1,fontSize:"0.7rem",fontWeight:600},children:"Manual"}),!t.available&&e.jsx(l,{sx:{backgroundColor:n.palette.grey[500],color:"white",px:1,py:.25,borderRadius:1,fontSize:"0.7rem",fontWeight:600},children:"Tidak Tersedia"})]}),e.jsx(s,{variant:"body2",color:"text.secondary",children:t.description})]})]})}),sx:{width:"100%",margin:0,mb:1,"& .MuiFormControlLabel-label":{width:"100%"},"&.Mui-disabled":{opacity:.5}}},t.id))})}),r.length===0&&e.jsx(l,{sx:{textAlign:"center",py:4,px:2,borderRadius:2,backgroundColor:n.palette.grey[50],border:`1px solid ${n.palette.grey[200]}`},children:e.jsx(s,{variant:"body2",color:"text.secondary",children:"Tidak ada metode pembayaran yang tersedia"})})]})})}function sr(){B();const r=re(),[a,o]=d.useState(!0),[n,t]=d.useState(!1),[m,h]=d.useState(null),[p,c]=d.useState(null),[u,j]=d.useState(null),[i,f]=d.useState(15e3),{items:y,clearCart:C}=ve(),{addOrder:S,setPaymentMethods:R,paymentMethods:v}=Ce(),g=x=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(x),I=y.filter(x=>x.product_variant.product.deleted_at===null),w=I.reduce((x,U)=>x+parseFloat(U.product_variant.price)*U.quantity,0),le=w+i,ce=async()=>{try{const x=await q.getPaymentMethods();x.success&&R(x.data)}catch(x){console.error("Error fetching payment methods:",x)}},de=async()=>{if(!p){h("Pilih alamat pengiriman terlebih dahulu");return}if(!u){h("Pilih metode pembayaran terlebih dahulu");return}if(I.length===0){h("Tidak ada item yang tersedia untuk checkout");return}try{t(!0),h(null);const x=await q.createOrder({address_id:p,shipping_cost:i});x.success&&(S(x.data),C(),r(`/payment/${x.data.id}`,{state:{message:"Order berhasil dibuat! Silakan lakukan pembayaran."}}))}catch(x){console.error("Error creating order:",x),h(x.response?.data?.error||"Gagal membuat order")}finally{t(!1)}};return d.useEffect(()=>{if(y.length===0){r("/cart");return}ce(),o(!1)},[y.length,r]),a?e.jsx(l,{sx:{minHeight:"100vh",py:4},children:e.jsx(G,{maxWidth:"xl",children:e.jsx(s,{children:"Loading..."})})}):I.length===0?e.jsx(l,{sx:{minHeight:"100vh",py:4},children:e.jsxs(G,{maxWidth:"xl",children:[e.jsx(A,{severity:"warning",sx:{mb:4},children:"Tidak ada item yang tersedia untuk checkout. Semua item di keranjang sudah tidak tersedia."}),e.jsx(z,{variant:"contained",onClick:()=>r("/cart"),children:"Kembali ke Keranjang"})]})}):e.jsx(l,{sx:{minHeight:"100vh",py:4},children:e.jsxs(G,{maxWidth:"xl",children:[e.jsxs(Ie,{sx:{mb:4},children:[e.jsxs(L,{component:"button",variant:"body2",onClick:()=>r("/"),sx:{display:"flex",alignItems:"center",textDecoration:"none",color:"text.secondary","&:hover":{color:"primary.main"}},children:[e.jsx(be,{sx:{mr:.5,fontSize:"1rem"}}),"Beranda"]}),e.jsxs(L,{component:"button",variant:"body2",onClick:()=>r("/cart"),sx:{display:"flex",alignItems:"center",textDecoration:"none",color:"text.secondary","&:hover":{color:"primary.main"}},children:[e.jsx(Y,{sx:{mr:.5,fontSize:"1rem"}}),"Keranjang"]}),e.jsxs(s,{variant:"body2",color:"text.primary",sx:{display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:.5,fontSize:"1rem"}}),"Checkout"]})]}),e.jsxs(l,{sx:{mb:4},children:[e.jsx(s,{variant:"h4",fontWeight:700,sx:{mb:1},children:"Checkout"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Lengkapi informasi pengiriman dan pembayaran"})]}),m&&e.jsx(A,{severity:"error",sx:{mb:4},onClose:()=>h(null),children:m}),e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"column",lg:"row"},gap:4,alignItems:"flex-start"},children:[e.jsx(l,{sx:{flex:1,minWidth:0,order:{xs:1,lg:1}},children:e.jsxs(k,{spacing:4,children:[e.jsx(Ve,{selectedAddress:p,onAddressSelect:c}),e.jsx(Ke,{paymentMethods:v,selectedMethod:u,onMethodSelect:j}),e.jsx(P,{children:e.jsxs(F,{children:[e.jsx(s,{variant:"h6",fontWeight:600,sx:{mb:2},children:"Biaya Pengiriman"}),e.jsxs(k,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(s,{variant:"body1",children:"Standard Delivery (2-3 hari kerja)"}),e.jsx(s,{variant:"h6",color:"primary.main",fontWeight:700,children:g(i)})]})]})})]})}),e.jsx(l,{sx:{width:{xs:"100%",lg:"400px"},flexShrink:0,order:{xs:2,lg:2}},children:e.jsx(He,{items:I,subtotal:w,shippingCost:i,total:le,onCreateOrder:de,creatingOrder:n,disabled:!p||!u})})]})]})})}export{sr as default};
