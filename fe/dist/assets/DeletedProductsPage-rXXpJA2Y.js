import{q as L,aB as $,r as n,j as e,ag as z,C as F,an as P,aA as H,T as t,B as o,t as v,x as N,w,I as W}from"./index-CLjvjqZT.js";import{p as D}from"./productApi-C49M6g00.js";import{B as G}from"./Breadcrumbs-CIb5IDov.js";import{H as K}from"./Home-BS3p-bFf.js";import{R as U}from"./Refresh-DQUm0Bly.js";import{A as _}from"./Alert-Cs6zeJMp.js";import{T as q,a as M,b as O,c as p,d as r,e as J}from"./TableRow-5-DPG7g8.js";import{A as Q}from"./Avatar-B6RLlSql.js";import{T as V}from"./Tooltip-BrgySCds.js";import{R as X}from"./Restore-vnOag46x.js";import{T as Y}from"./TablePagination-ByuaW9VP.js";import"./useSlot-CDkgSjON.js";import"./Popper-Bu6D8dQx.js";import"./KeyboardArrowRight-BMzCiM98.js";import"./LastPage-DTDVOSKy.js";function ue(){const l=L(),{showNotification:j}=$(),[d,I]=n.useState([]),[c,f]=n.useState(!0),[y,h]=n.useState(null),[m,b]=n.useState(0),[x,C]=n.useState(10),[k,S]=n.useState(0),u=async a=>{try{f(!0),h(null);const s=await D.getDeletedProducts({page:(m||0)+1,limit:x,...a});if(s.success)I(s.data),S(s.pagination?.total||0);else throw new Error("Failed to fetch deleted products")}catch(s){h(s.message||"Gagal memuat data produk yang dihapus")}finally{f(!1)}};n.useEffect(()=>{u()},[m,x]);const T=async(a,s)=>{if(window.confirm(`Apakah Anda yakin ingin memulihkan produk "${s}"?`))try{const i=await D.restoreProduct(a);if(i.success)j({type:"success",message:"Produk berhasil dipulihkan"}),await u();else throw new Error(i.message||"Failed to restore product")}catch(i){j({type:"error",message:i.message||"Gagal memulihkan produk"})}},R=(a,s)=>{b(s)},A=a=>{C(parseInt(a.target.value,10)),b(0)},B=()=>{u()},E=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a);return c&&d.length===0?e.jsx(z,{message:"Memuat data produk yang dihapus..."}):e.jsxs(F,{maxWidth:!1,children:[e.jsxs(G,{sx:{mb:3},children:[e.jsxs(P,{component:"button",variant:"body2",onClick:()=>l("/admin"),sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(K,{fontSize:"small"}),"Dashboard"]}),e.jsxs(P,{component:"button",variant:"body2",onClick:()=>l("/admin/products"),sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(H,{fontSize:"small"}),"Produk"]}),e.jsx(t,{variant:"body2",color:"textPrimary",children:"Produk Dihapus"})]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(o,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Produk yang Dihapus"}),e.jsx(t,{variant:"body1",color:"textSecondary",children:"Kelola produk yang telah dihapus (soft delete)"})]}),e.jsxs(o,{sx:{display:"flex",gap:2},children:[e.jsx(v,{variant:"outlined",startIcon:e.jsx(U,{}),onClick:B,disabled:c,children:"Refresh"}),e.jsx(v,{variant:"outlined",onClick:()=>l("/admin/products"),children:"Kembali ke Produk"})]})]}),y&&e.jsx(_,{severity:"error",sx:{mb:3},onClose:()=>h(null),children:y}),e.jsx(q,{component:N,children:e.jsxs(M,{children:[e.jsx(O,{children:e.jsxs(p,{children:[e.jsx(r,{children:"Gambar"}),e.jsx(r,{children:"Nama Produk"}),e.jsx(r,{children:"Kategori"}),e.jsx(r,{align:"right",children:"Harga"}),e.jsx(r,{align:"center",children:"Stok"}),e.jsx(r,{children:"Dibuat"}),e.jsx(r,{children:"Dihapus"}),e.jsx(r,{align:"center",children:"Aksi"})]})}),e.jsx(J,{children:d.length===0?e.jsx(p,{children:e.jsx(r,{colSpan:8,align:"center",sx:{py:4},children:e.jsx(t,{variant:"body1",color:"textSecondary",children:"Tidak ada produk yang dihapus"})})}):d.map(a=>e.jsxs(p,{hover:!0,children:[e.jsx(r,{children:e.jsx(Q,{variant:"rounded",sx:{width:40,height:40},children:a.name.charAt(0).toUpperCase()})}),e.jsx(r,{children:e.jsxs(o,{children:[e.jsx(t,{variant:"body1",fontWeight:"medium",children:a.name}),e.jsx(t,{variant:"body2",color:"textSecondary",children:a.description||"-"})]})}),e.jsx(r,{children:e.jsx(w,{label:a.category?.name||"Tidak ada kategori",size:"small",color:"primary",variant:"outlined"})}),e.jsx(r,{align:"right",children:e.jsx(t,{variant:"body1",fontWeight:"medium",children:E(a.price)})}),e.jsx(r,{align:"center",children:e.jsx(w,{label:a.stock,size:"small",color:a.stock>0?"success":"error",variant:a.stock>0?"filled":"outlined"})}),e.jsx(r,{children:e.jsx(t,{variant:"body2",children:new Date(a.created_at).toLocaleDateString("id-ID")})}),e.jsx(r,{children:e.jsx(t,{variant:"body2",color:"error",children:new Date(a.deleted_at).toLocaleDateString("id-ID")})}),e.jsx(r,{align:"center",children:e.jsx(V,{title:"Pulihkan Produk",children:e.jsx(W,{color:"primary",onClick:()=>T(a.id,a.name),disabled:c,children:e.jsx(X,{})})})})]},a.id))})]})}),k>0&&e.jsx(Y,{rowsPerPageOptions:[5,10,25,50],component:"div",count:k,rowsPerPage:x,page:m,onPageChange:R,onRowsPerPageChange:A,labelRowsPerPage:"Baris per halaman:",labelDisplayedRows:({from:a,to:s,count:g})=>`${a}-${s} dari ${g!==-1?g:`lebih dari ${s}`}`})]})}export{ue as default};
