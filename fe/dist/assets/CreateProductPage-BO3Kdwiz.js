import{q as P,aB as C,r as s,j as r,C as S,ao as d,aA as B,T as c,B as _,z as v}from"./index-D0K_J5MH.js";import{p as l}from"./productApi-BJP6DUOH.js";import{P as w}from"./ProductForm-CyFIcpAg.js";import{B as F}from"./Breadcrumbs-DQSd1Cz1.js";import{H as I}from"./Home-CZoMJq0w.js";import"./schemas-CK4uTdXz.js";import"./ProductVariantManager-BbFT8JXs.js";import"./CardContent-7fkJvOwG.js";import"./Alert-D2FNR8Ya.js";import"./Add-DtNoIuQN.js";import"./Delete-BY8eW1nK.js";import"./Tooltip-qpArd1Jc.js";import"./Popper-A-4shGZ6.js";import"./CloudUpload-CBIjH9ln.js";import"./TableRow-D7Wp4-LE.js";import"./Image-C6BbQOIn.js";import"./Edit-xqQzbt_u.js";import"./DialogTitle-BCSOKhKg.js";import"./DialogActions-DjBbw8WJ.js";import"./image-CeHRN-zl.js";import"./ProductImageManager-CM_62Wju.js";import"./Star-C5pBDb5e.js";import"./CardMedia-CWMZvEzf.js";import"./FormControlLabel-SDb0xOiw.js";import"./Switch-CY7eEnLl.js";function ta(){const o=P(),{showNotification:i}=C(),[u,g]=s.useState([]),[h,m]=s.useState(!1),[b,n]=s.useState(null),f=async()=>{try{const a=await v.getCategories();a.success&&g(a.data)}catch(a){console.error("Failed to fetch categories:",a),n("Gagal memuat data kategori")}};s.useEffect(()=>{f()},[]);const x=async a=>{try{m(!0),n(null);const t=a._imageFiles||[],k={category_id:a.category_id,name:a.name,description:a.description,price:a.price,stock:a.stock,pre_order:a.pre_order},p=await l.createProduct(k);if(!p.success)throw new Error("Failed to create product");const j=p.data.id;if(t.length>0)try{for(let e=0;e<t.length;e++)await l.createProductImage(j,{image_name:"",is_primary:e===0,_imageFile:t[e]});i({type:"success",message:`Produk berhasil ditambahkan dengan ${t.length} gambar`})}catch(e){console.error("Failed to upload images:",e),i({type:"warning",message:"Produk berhasil dibuat, tapi gagal upload beberapa gambar. Silakan upload manual."})}else i({type:"success",message:"Produk berhasil ditambahkan"});o("/admin/products")}catch(t){n(t.message||"Gagal menambahkan produk")}finally{m(!1)}},y=()=>{o("/admin/products")};return r.jsxs(S,{maxWidth:!1,children:[r.jsxs(F,{sx:{mb:3},children:[r.jsxs(d,{component:"button",variant:"body2",onClick:()=>o("/admin"),sx:{display:"flex",alignItems:"center",gap:.5},children:[r.jsx(I,{fontSize:"small"}),"Dashboard"]}),r.jsxs(d,{component:"button",variant:"body2",onClick:()=>o("/admin/products"),sx:{display:"flex",alignItems:"center",gap:.5},children:[r.jsx(B,{fontSize:"small"}),"Produk"]}),r.jsx(c,{variant:"body2",color:"textPrimary",children:"Tambah Baru"})]}),r.jsxs(_,{sx:{mb:4},children:[r.jsx(c,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Tambah Produk Baru"}),r.jsx(c,{variant:"body1",color:"textSecondary",children:"Buat produk baru untuk toko Anda"})]}),r.jsx(w,{mode:"create",categories:u,isLoading:h,error:b,onSubmit:x,onCancel:y})]})}export{ta as default};
