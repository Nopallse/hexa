import{a as L,ar as $,r as n,j as e,Y as z,C as F,$ as k,a0 as N,aq as W,T as t,B as o,b as v,P as G,R as H,e as w,i as K}from"./index-BNHkdQXN.js";import{p as D}from"./productApi-DD1g0Rr2.js";import{B as U}from"./Breadcrumbs-CE1cFXMC.js";import{R as _,a as q}from"./Restore-CRIBth3K.js";import{A as M}from"./Alert-CGwzUP-j.js";import{T as O,a as Y,b as J,c as p,d as s,e as Q}from"./TableRow-B4eIPwcd.js";import{T as V}from"./Tooltip-B_Lp-BkP.js";import{T as X}from"./TablePagination-Db_fT23d.js";import"./KeyboardArrowRight-CkSo5XDM.js";import"./LastPage-DHkSoxah.js";function de(){const l=L(),{showNotification:j}=$(),[d,C]=n.useState([]),[c,y]=n.useState(!0),[f,h]=n.useState(null),[m,b]=n.useState(0),[x,I]=n.useState(10),[P,S]=n.useState(0),u=async a=>{try{y(!0),h(null);const r=await D.getDeletedProducts({page:(m||0)+1,limit:x,...a});if(r.success)C(r.data),S(r.pagination?.total||0);else throw new Error("Failed to fetch deleted products")}catch(r){h(r.message||"Gagal memuat data produk yang dihapus")}finally{y(!1)}};n.useEffect(()=>{u()},[m,x]);const T=async(a,r)=>{if(window.confirm(`Apakah Anda yakin ingin memulihkan produk "${r}"?`))try{const i=await D.restoreProduct(a);if(i.success)j({type:"success",message:"Produk berhasil dipulihkan"}),await u();else throw new Error(i.message||"Failed to restore product")}catch(i){j({type:"error",message:i.message||"Gagal memulihkan produk"})}},R=(a,r)=>{b(r)},B=a=>{I(parseInt(a.target.value,10)),b(0)},A=()=>{u()},E=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a);return c&&d.length===0?e.jsx(z,{message:"Memuat data produk yang dihapus..."}):e.jsxs(F,{maxWidth:!1,children:[e.jsxs(U,{sx:{mb:3},children:[e.jsxs(k,{component:"button",variant:"body2",onClick:()=>l("/admin"),sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(N,{fontSize:"small"}),"Dashboard"]}),e.jsxs(k,{component:"button",variant:"body2",onClick:()=>l("/admin/products"),sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(W,{fontSize:"small"}),"Produk"]}),e.jsx(t,{variant:"body2",color:"textPrimary",children:"Produk Dihapus"})]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(o,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Produk yang Dihapus"}),e.jsx(t,{variant:"body1",color:"textSecondary",children:"Kelola produk yang telah dihapus (soft delete)"})]}),e.jsxs(o,{sx:{display:"flex",gap:2},children:[e.jsx(v,{variant:"outlined",startIcon:e.jsx(_,{}),onClick:A,disabled:c,children:"Refresh"}),e.jsx(v,{variant:"outlined",onClick:()=>l("/admin/products"),children:"Kembali ke Produk"})]})]}),f&&e.jsx(M,{severity:"error",sx:{mb:3},onClose:()=>h(null),children:f}),e.jsx(O,{component:G,children:e.jsxs(Y,{children:[e.jsx(J,{children:e.jsxs(p,{children:[e.jsx(s,{children:"Gambar"}),e.jsx(s,{children:"Nama Produk"}),e.jsx(s,{children:"Kategori"}),e.jsx(s,{align:"right",children:"Harga"}),e.jsx(s,{align:"center",children:"Stok"}),e.jsx(s,{children:"Dibuat"}),e.jsx(s,{children:"Dihapus"}),e.jsx(s,{align:"center",children:"Aksi"})]})}),e.jsx(Q,{children:d.length===0?e.jsx(p,{children:e.jsx(s,{colSpan:8,align:"center",sx:{py:4},children:e.jsx(t,{variant:"body1",color:"textSecondary",children:"Tidak ada produk yang dihapus"})})}):d.map(a=>e.jsxs(p,{hover:!0,children:[e.jsx(s,{children:e.jsx(H,{variant:"rounded",sx:{width:40,height:40},children:a.name.charAt(0).toUpperCase()})}),e.jsx(s,{children:e.jsxs(o,{children:[e.jsx(t,{variant:"body1",fontWeight:"medium",children:a.name}),e.jsx(t,{variant:"body2",color:"textSecondary",children:a.description||"-"})]})}),e.jsx(s,{children:e.jsx(w,{label:a.category?.name||"Tidak ada kategori",size:"small",color:"primary",variant:"outlined"})}),e.jsx(s,{align:"right",children:e.jsx(t,{variant:"body1",fontWeight:"medium",children:E(a.price)})}),e.jsx(s,{align:"center",children:e.jsx(w,{label:a.stock,size:"small",color:a.stock>0?"success":"error",variant:a.stock>0?"filled":"outlined"})}),e.jsx(s,{children:e.jsx(t,{variant:"body2",children:new Date(a.created_at).toLocaleDateString("id-ID")})}),e.jsx(s,{children:e.jsx(t,{variant:"body2",color:"error",children:new Date(a.deleted_at).toLocaleDateString("id-ID")})}),e.jsx(s,{align:"center",children:e.jsx(V,{title:"Pulihkan Produk",children:e.jsx(K,{color:"primary",onClick:()=>T(a.id,a.name),disabled:c,children:e.jsx(q,{})})})})]},a.id))})]})}),P>0&&e.jsx(X,{rowsPerPageOptions:[5,10,25,50],component:"div",count:P,rowsPerPage:x,page:m,onPageChange:R,onRowsPerPageChange:B,labelRowsPerPage:"Baris per halaman:",labelDisplayedRows:({from:a,to:r,count:g})=>`${a}-${r} dari ${g!==-1?g:`lebih dari ${r}`}`})]})}export{de as default};
