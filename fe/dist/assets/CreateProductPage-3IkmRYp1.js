import{q as P,aB as C,r as s,j as t,C as S,an as d,aA as B,T as c,B as v,A as I}from"./index-tvCmUXkA.js";import{p as l}from"./productApi-uU0QhFhc.js";import{P as _}from"./ProductForm-DYzxff5A.js";import{B as w}from"./Breadcrumbs-BRY0wQO3.js";import{H as F}from"./Home-FYrVyE1n.js";import"./schemas-DXr8hVXD.js";import"./ProductVariantManager-TIBheUgC.js";import"./CardContent-BO7gwO4c.js";import"./Alert-iJ2nvuQL.js";import"./useSlot-Dd61XFNI.js";import"./Add-DOZR1gGR.js";import"./Delete-n8OHpdJZ.js";import"./Tooltip-CRdXSvuP.js";import"./Popper-DMWFBkOI.js";import"./CloudUpload-CzVTKydN.js";import"./TableRow-Bx2Iwbxr.js";import"./Image-CNtbBRWI.js";import"./Edit-EiFO075a.js";import"./DialogTitle-yi9wgBEI.js";import"./DialogActions-Bmmc9LId.js";import"./image-CeHRN-zl.js";import"./Avatar-Cw6JEpzV.js";import"./ProductImageManager-Cy2IzSFQ.js";import"./Star-DOsCIKRk.js";import"./CardMedia-BoJ7BMDL.js";import"./Info-Bhxc4y46.js";import"./Switch-CnptKaHY.js";import"./SwitchBase-nOO8HfEz.js";function sr(){const o=P(),{showNotification:i}=C(),[u,g]=s.useState([]),[h,m]=s.useState(!1),[b,n]=s.useState(null),f=async()=>{try{const r=await I.getCategories();r.success&&g(r.data)}catch(r){console.error("Failed to fetch categories:",r),n("Gagal memuat data kategori")}};s.useEffect(()=>{f()},[]);const x=async r=>{try{m(!0),n(null);const a=r._imageFiles||[],k={category_id:r.category_id,name:r.name,description:r.description,price:r.price,stock:r.stock,pre_order:r.pre_order},p=await l.createProduct(k);if(!p.success)throw new Error("Failed to create product");const j=p.data.id;if(a.length>0)try{for(let e=0;e<a.length;e++)await l.createProductImage(j,{image_name:"",is_primary:e===0,_imageFile:a[e]});i({type:"success",message:`Produk berhasil ditambahkan dengan ${a.length} gambar`})}catch(e){console.error("Failed to upload images:",e),i({type:"warning",message:"Produk berhasil dibuat, tapi gagal upload beberapa gambar. Silakan upload manual."})}else i({type:"success",message:"Produk berhasil ditambahkan"});o("/admin/products")}catch(a){n(a.message||"Gagal menambahkan produk")}finally{m(!1)}},y=()=>{o("/admin/products")};return t.jsxs(S,{maxWidth:!1,children:[t.jsxs(w,{sx:{mb:3},children:[t.jsxs(d,{component:"button",variant:"body2",onClick:()=>o("/admin"),sx:{display:"flex",alignItems:"center",gap:.5},children:[t.jsx(F,{fontSize:"small"}),"Dashboard"]}),t.jsxs(d,{component:"button",variant:"body2",onClick:()=>o("/admin/products"),sx:{display:"flex",alignItems:"center",gap:.5},children:[t.jsx(B,{fontSize:"small"}),"Produk"]}),t.jsx(c,{variant:"body2",color:"textPrimary",children:"Tambah Baru"})]}),t.jsxs(v,{sx:{mb:4},children:[t.jsx(c,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Tambah Produk Baru"}),t.jsx(c,{variant:"body1",color:"textSecondary",children:"Buat produk baru untuk toko Anda"})]}),t.jsx(_,{mode:"create",categories:u,isLoading:h,error:b,onSubmit:x,onCancel:y})]})}export{sr as default};
