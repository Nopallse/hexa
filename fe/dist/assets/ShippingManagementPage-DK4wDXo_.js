import{c as $,j as e,r as l,B as o,E as L,T as i,S as z,D as j,t as C,ag as Q,q as X,aE as ee,ab as re,C as te,ak as ae,H as se,v as F,aB as ie,I as ne}from"./index-7B7oaQt6.js";import{l as W}from"./locationApi-3iQcHOzI.js";import{u as oe,a as ce,o as le,s as v,n as de,l as me}from"./schemas-DMYtl8IP.js";import{C as p,a as u}from"./CardContent-6W3rtoXv.js";import{A as _}from"./Alert-Cx2n4D67.js";import{B as he}from"./Breadcrumbs-CsFda7LN.js";import{H as xe}from"./Home-DmkpuMel.js";import{R as J}from"./Refresh-Bw0266fD.js";import{G as x}from"./Grid-oFAKRJBw.js";import{E as pe}from"./Edit-D0bCq-xV.js";import{S as R}from"./Schedule-C86DOaz7.js";import{C as M}from"./CheckCircle-BNrwfe0M.js";import{T as ue,a as ge,b as be,c as H,d as n,e as fe}from"./TableRow-f9kk4Ayo.js";import{T as je}from"./Tooltip-DV4xBgnO.js";import{V as ye}from"./Visibility-CPONTGGI.js";import"./useSlot-BMQvfvuc.js";import"./Popper-giCiIagY.js";const V=$(e.jsx("path",{d:"M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5zm-.5 1.5 1.96 2.5H17V9.5zM6 18c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m2.22-3c-.55-.61-1.33-1-2.22-1s-1.67.39-2.22 1H3V6h12v9zM18 18c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"LocalShippingOutlined"),ke={totalOrders:156,pendingShipment:23,inTransit:45,delivered:88,totalRevenue:125e5},N=[{id:"SH001",orderId:"ORD-2024-001",recipient:"John Doe",destination:"Jakarta Selatan",courier:"JNE",status:"delivered",trackingNumber:"JNE123456789",createdAt:"2024-01-15",deliveredAt:"2024-01-17",shippingCost:15e3},{id:"SH002",orderId:"ORD-2024-002",recipient:"Jane Smith",destination:"Bandung",courier:"TIKI",status:"in_transit",trackingNumber:"TIKI987654321",createdAt:"2024-01-16",deliveredAt:null,estimatedDelivery:"2024-01-18",shippingCost:12e3},{id:"SH003",orderId:"ORD-2024-003",recipient:"Bob Johnson",destination:"Surabaya",courier:"POS",status:"pending",trackingNumber:null,createdAt:"2024-01-17",deliveredAt:null,estimatedDelivery:"2024-01-19",shippingCost:18e3},{id:"SH004",orderId:"ORD-2024-004",recipient:"Alice Brown",destination:"Medan",courier:"JNE",status:"in_transit",trackingNumber:"JNE456789123",createdAt:"2024-01-18",deliveredAt:null,estimatedDelivery:"2024-01-20",shippingCost:2e4},{id:"SH005",orderId:"ORD-2024-005",recipient:"Charlie Wilson",destination:"Yogyakarta",courier:"TIKI",status:"delivered",trackingNumber:"TIKI789123456",createdAt:"2024-01-19",deliveredAt:"2024-01-21",shippingCost:14e3}],K={getShippingStats:async()=>{try{return{success:!0,message:"Shipping statistics retrieved successfully",data:ke}}catch(s){return{success:!1,message:"Failed to fetch shipping statistics",error:s.message}}},getShippingData:async s=>{try{let t=[...N];s?.status&&(t=t.filter(g=>g.status===s.status)),s?.courier&&(t=t.filter(g=>g.courier===s.courier));const a=s?.page||1,d=s?.limit||10,m=(a-1)*d,y=m+d;return{success:!0,message:"Shipping data retrieved successfully",data:t.slice(m,y)}}catch(t){return{success:!1,message:"Failed to fetch shipping data",error:t.message}}},getShippingDetail:async s=>{try{const t=N.find(a=>a.id===s);return t?{success:!0,message:"Shipping detail retrieved successfully",data:t}:{success:!1,message:"Shipping data not found",error:"Shipping data not found"}}catch(t){return{success:!1,message:"Failed to fetch shipping detail",error:t.message}}},updateShippingStatus:async(s,t)=>{try{const a=N.find(d=>d.id===s);return a?(a.status=t,{success:!0,message:"Shipping status updated successfully",data:a}):{success:!1,message:"Shipping data not found",error:"Shipping data not found"}}catch(a){return{success:!1,message:"Failed to update shipping status",error:a.message}}},getTrackingInfo:async s=>{try{return{success:!0,message:"Tracking information retrieved successfully",data:{trackingNumber:s,status:"in_transit",courier:"JNE",origin:"Jakarta",destination:"Bandung",estimatedDelivery:"2024-01-20",history:[{status:"picked_up",description:"Paket telah diambil oleh kurir",timestamp:"2024-01-18T10:00:00Z",location:"Jakarta"},{status:"in_transit",description:"Paket dalam perjalanan ke tujuan",timestamp:"2024-01-18T14:30:00Z",location:"Jakarta"},{status:"in_transit",description:"Paket tiba di hub Bandung",timestamp:"2024-01-19T08:15:00Z",location:"Bandung"}]}}}catch(t){return{success:!1,message:"Failed to fetch tracking information",error:t.message}}},refreshShippingData:async()=>{try{return{success:!0,message:"Shipping data refreshed successfully",data:{refreshedAt:new Date().toISOString()}}}catch(s){return{success:!1,message:"Failed to refresh shipping data",error:s.message}}}},Se=le({name:v().min(1,"Nama lokasi wajib diisi").min(2,"Nama lokasi minimal 2 karakter").max(100,"Nama lokasi maksimal 100 karakter"),contact_name:v().min(1,"Nama kontak wajib diisi").min(2,"Nama kontak minimal 2 karakter").max(100,"Nama kontak maksimal 100 karakter"),contact_phone:v().min(1,"Nomor telepon wajib diisi").min(10,"Nomor telepon minimal 10 digit").max(15,"Nomor telepon maksimal 15 digit").regex(/^[0-9+\-\s()]+$/,"Nomor telepon hanya boleh berisi angka dan simbol +, -, (, ), spasi"),address:v().min(1,"Alamat wajib diisi").min(10,"Alamat minimal 10 karakter").max(500,"Alamat maksimal 500 karakter"),postal_code:de().int("Kode pos harus berupa bilangan bulat").min(1e4,"Kode pos minimal 10000").max(99999,"Kode pos maksimal 99999"),note:v().max(200,"Catatan maksimal 200 karakter").optional().or(me(""))});function ve({mode:s,location:t,isLoading:a=!1,error:d,onSubmit:m,onCancel:y}){const{register:h,handleSubmit:g,formState:{errors:c},reset:k}=oe({resolver:ce(Se),defaultValues:{name:"",contact_name:"",contact_phone:"",address:"",postal_code:0,note:""}});l.useEffect(()=>{t&&k({name:t.name,contact_name:t.contact_name,contact_phone:t.contact_phone,address:t.address,postal_code:t.postal_code,note:t.note||""})},[t,k]);const D=async b=>{await m(b)};return e.jsx(p,{children:e.jsxs(u,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(L,{sx:{fontSize:"1.5rem",mr:1,color:"primary.main"}}),e.jsx(i,{variant:"h6",fontWeight:600,children:"Edit Lokasi Origin"})]}),d&&e.jsx(_,{severity:"error",sx:{mb:3},children:d}),e.jsx(o,{component:"form",onSubmit:g(D),sx:{mt:3},children:e.jsxs(z,{spacing:3,children:[e.jsx(i,{variant:"h6",fontWeight:"bold",children:"Informasi Dasar"}),e.jsx(j,{...h("name"),label:"Nama Lokasi",fullWidth:!0,error:!!c.name,helperText:c.name?.message,disabled:a,placeholder:"Contoh: Toko Utama Jakarta",required:!0}),e.jsx(j,{...h("contact_name"),label:"Nama Kontak",fullWidth:!0,error:!!c.contact_name,helperText:c.contact_name?.message,disabled:a,placeholder:"Contoh: Ahmad",required:!0}),e.jsx(j,{...h("contact_phone"),label:"Nomor Telepon",fullWidth:!0,error:!!c.contact_phone,helperText:c.contact_phone?.message,disabled:a,placeholder:"Contoh: 08123456789",required:!0}),e.jsx(i,{variant:"h6",fontWeight:"bold",sx:{mt:2},children:"Informasi Alamat"}),e.jsx(j,{...h("address"),label:"Alamat Lengkap",fullWidth:!0,multiline:!0,rows:3,error:!!c.address,helperText:c.address?.message,disabled:a,placeholder:"Contoh: Jl. Gambir Selatan no 5. Blok F 92. Jakarta Pusat.",required:!0}),e.jsx(j,{...h("postal_code",{valueAsNumber:!0,setValueAs:b=>{const f=parseInt(b);return isNaN(f)?0:f}}),label:"Kode Pos",fullWidth:!0,type:"number",error:!!c.postal_code,helperText:c.postal_code?.message,disabled:a,placeholder:"10110",required:!0,InputProps:{inputProps:{min:1e4,max:99999,style:{textAlign:"right"}}}}),e.jsx(j,{...h("note"),label:"Catatan (Opsional)",fullWidth:!0,multiline:!0,rows:2,error:!!c.note,helperText:c.note?.message||"Catatan tambahan untuk lokasi ini",disabled:a,placeholder:"Contoh: Dekat tulisan warung Bu Indah"}),e.jsxs(z,{direction:"row",spacing:2,sx:{mt:4},children:[e.jsx(C,{type:"submit",variant:"contained",disabled:a,startIcon:a?e.jsx(Q,{size:20}):void 0,sx:{minWidth:120},children:a?"Menyimpan...":"Simpan Perubahan"}),e.jsx(C,{variant:"outlined",onClick:y,disabled:a,sx:{minWidth:120},children:"Batal"})]})]})})]})})}const Ce=s=>{switch(s){case"delivered":return"success";case"in_transit":return"info";case"pending":return"warning";default:return"default"}},Ie=s=>{switch(s){case"delivered":return e.jsx(M,{});case"in_transit":return e.jsx(V,{});case"pending":return e.jsx(R,{});default:return e.jsx(R,{})}},Te=s=>{switch(s){case"delivered":return"Terkirim";case"in_transit":return"Dalam Perjalanan";case"pending":return"Menunggu Pengiriman";default:return"Unknown"}};function Me(){const s=X(),{showNotification:t}=ee(),[a,d]=l.useState(null),[m,y]=l.useState(null),[h,g]=l.useState([]),[c,k]=l.useState(!0),[D,b]=l.useState(!1),[f,S]=l.useState(null),[I,A]=l.useState(null),[w,q]=l.useState(null),T=async()=>{try{k(!0),S(null);const r=await W.getActiveOriginLocation();if(r.success)d(r.data);else throw new Error("Failed to fetch active origin")}catch(r){S(r.message||"Gagal memuat data lokasi origin")}finally{k(!1)}},P=async()=>{try{const r=await K.getShippingStats();r.success&&r.data&&y(r.data)}catch(r){console.error("Failed to fetch shipping stats:",r)}},O=async()=>{try{const r=await K.getShippingData({limit:10});r.success&&r.data&&g(r.data)}catch(r){console.error("Failed to fetch shipping data:",r)}},B=async()=>{try{const r=await W.checkConfigStatus();r.success&&r.data&&q({biteshipConfigured:r.data.biteshipConfigured,message:r.data.message})}catch(r){console.error("Failed to fetch API config status:",r)}};l.useEffect(()=>{(async()=>{await Promise.all([T(),P(),O(),B()])})()},[]);const G=async r=>{if(I)try{if(b(!0),S(null),(await W.updateLocation(I.id,r)).success)t({type:"success",message:"Lokasi origin berhasil diperbarui"}),A(null),await T();else throw new Error("Failed to update location")}catch(E){S(E.message||"Gagal memperbarui lokasi")}finally{b(!1)}},U=()=>{a&&A(a)},Z=()=>{A(null),S(null)},Y=async()=>{await Promise.all([T(),P(),O(),B()])};return c?e.jsx(re,{message:"Memuat data lokasi origin..."}):e.jsxs(te,{maxWidth:"xl",sx:{py:4},children:[e.jsxs(he,{sx:{mb:4},children:[e.jsxs(ae,{component:"button",variant:"body2",onClick:()=>s("/admin"),sx:{display:"flex",alignItems:"center",gap:.5,color:"text.secondary",textDecoration:"none","&:hover":{color:"primary.main",textDecoration:"underline"}},children:[e.jsx(xe,{fontSize:"small"}),"Dashboard"]}),e.jsx(i,{variant:"body2",color:"textPrimary",sx:{fontWeight:500},children:"Pengiriman"})]}),e.jsxs(o,{sx:{mb:4},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(se,{sx:{fontSize:"2rem",color:"primary.main"}}),e.jsx(i,{variant:"h4",fontWeight:700,color:"text.primary",className:"craft-heading",children:"Manajemen Pengiriman"})]}),e.jsx(C,{variant:"outlined",startIcon:e.jsx(J,{}),onClick:Y,sx:{borderRadius:2,px:3,py:1,fontWeight:500,textTransform:"none",borderColor:"primary.main",color:"primary.main","&:hover":{backgroundColor:"rgba(150, 130, 219, 0.05)",borderColor:"primary.dark"}},children:"Refresh Data"})]}),e.jsx(i,{variant:"body1",color:"text.secondary",className:"craft-body",children:"Kelola lokasi origin, statistik pengiriman, dan tracking order"})]}),f&&e.jsx(_,{severity:"error",sx:{mb:3,borderRadius:2,backgroundColor:"error.light",color:"error.dark",border:"1px solid",borderColor:"error.main"},children:f}),w&&!w.biteshipConfigured&&e.jsxs(_,{severity:"warning",sx:{mb:3,borderRadius:2,backgroundColor:"warning.light",color:"warning.dark",border:"1px solid",borderColor:"warning.main"},children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{mb:1},children:"âš ï¸ Biteship API Tidak Dikonfigurasi"}),e.jsx(i,{variant:"body2",children:w.message})]}),I?e.jsx(p,{sx:{borderRadius:3,boxShadow:"0 4px 16px rgba(150, 130, 219, 0.12)",border:"1px solid rgba(150, 130, 219, 0.08)",mb:4},children:e.jsx(u,{sx:{p:4},children:e.jsx(ve,{mode:"edit",location:I,isLoading:D,error:f,onSubmit:G,onCancel:Z})})}):e.jsxs(o,{children:[e.jsxs(x,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(x,{item:!0,xs:12,md:4,children:e.jsx(p,{sx:{borderRadius:3,boxShadow:"0 4px 16px rgba(150, 130, 219, 0.12)",border:"1px solid rgba(150, 130, 219, 0.08)",height:"100%"},children:e.jsxs(u,{sx:{p:3},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2},children:[e.jsx(o,{sx:{p:1,borderRadius:1.5,backgroundColor:"primary.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(L,{sx:{fontSize:"1.2rem"}})}),e.jsx(i,{variant:"h6",fontWeight:600,color:"text.primary",className:"craft-heading",children:"Lokasi Origin"})]}),a?e.jsxs(o,{children:[e.jsx(i,{variant:"body1",fontWeight:600,color:"text.primary",sx:{mb:.5},children:a.name}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:a.address}),e.jsxs(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["ðŸ“® ",a.postal_code," | ðŸ“ž ",a.contact_phone]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(F,{label:"Aktif",size:"small",sx:{backgroundColor:"success.main",color:"white",fontWeight:600}}),e.jsx(C,{variant:"outlined",size:"small",startIcon:e.jsx(pe,{}),onClick:U,sx:{borderRadius:2,px:2,py:.5,fontWeight:500,textTransform:"none",borderColor:"primary.main",color:"primary.main","&:hover":{backgroundColor:"rgba(150, 130, 219, 0.05)",borderColor:"primary.dark"}},children:"Edit"})]})]}):e.jsxs(o,{sx:{textAlign:"center",py:2},children:[e.jsx(i,{variant:"body2",color:"text.secondary",children:"Belum ada lokasi origin"}),e.jsx(C,{variant:"outlined",size:"small",startIcon:e.jsx(J,{}),onClick:T,sx:{mt:1},children:"Refresh"})]})]})})}),e.jsx(x,{item:!0,xs:12,md:8,children:e.jsxs(x,{container:!0,spacing:2,children:[e.jsx(x,{item:!0,xs:6,md:3,children:e.jsx(p,{sx:{borderRadius:3,boxShadow:"0 4px 16px rgba(150, 130, 219, 0.12)",border:"1px solid rgba(150, 130, 219, 0.08)",height:"100%"},children:e.jsxs(u,{sx:{p:2,textAlign:"center"},children:[e.jsx(o,{sx:{p:1.5,borderRadius:"50%",backgroundColor:"rgba(150, 130, 219, 0.1)",display:"inline-flex",alignItems:"center",justifyContent:"center",mb:1},children:e.jsx(ie,{sx:{fontSize:"1.5rem",color:"primary.main"}})}),e.jsx(i,{variant:"h6",fontWeight:700,color:"text.primary",children:m?.totalOrders||0}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Total Order"})]})})}),e.jsx(x,{item:!0,xs:6,md:3,children:e.jsx(p,{sx:{borderRadius:3,boxShadow:"0 4px 16px rgba(150, 130, 219, 0.12)",border:"1px solid rgba(150, 130, 219, 0.08)",height:"100%"},children:e.jsxs(u,{sx:{p:2,textAlign:"center"},children:[e.jsx(o,{sx:{p:1.5,borderRadius:"50%",backgroundColor:"rgba(243, 156, 18, 0.1)",display:"inline-flex",alignItems:"center",justifyContent:"center",mb:1},children:e.jsx(R,{sx:{fontSize:"1.5rem",color:"warning.main"}})}),e.jsx(i,{variant:"h6",fontWeight:700,color:"text.primary",children:m?.pendingShipment||0}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Menunggu Kirim"})]})})}),e.jsx(x,{item:!0,xs:6,md:3,children:e.jsx(p,{sx:{borderRadius:3,boxShadow:"0 4px 16px rgba(150, 130, 219, 0.12)",border:"1px solid rgba(150, 130, 219, 0.08)",height:"100%"},children:e.jsxs(u,{sx:{p:2,textAlign:"center"},children:[e.jsx(o,{sx:{p:1.5,borderRadius:"50%",backgroundColor:"rgba(52, 152, 219, 0.1)",display:"inline-flex",alignItems:"center",justifyContent:"center",mb:1},children:e.jsx(V,{sx:{fontSize:"1.5rem",color:"info.main"}})}),e.jsx(i,{variant:"h6",fontWeight:700,color:"text.primary",children:m?.inTransit||0}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Dalam Perjalanan"})]})})}),e.jsx(x,{item:!0,xs:6,md:3,children:e.jsx(p,{sx:{borderRadius:3,boxShadow:"0 4px 16px rgba(150, 130, 219, 0.12)",border:"1px solid rgba(150, 130, 219, 0.08)",height:"100%"},children:e.jsxs(u,{sx:{p:2,textAlign:"center"},children:[e.jsx(o,{sx:{p:1.5,borderRadius:"50%",backgroundColor:"rgba(39, 174, 96, 0.1)",display:"inline-flex",alignItems:"center",justifyContent:"center",mb:1},children:e.jsx(M,{sx:{fontSize:"1.5rem",color:"success.main"}})}),e.jsx(i,{variant:"h6",fontWeight:700,color:"text.primary",children:m?.delivered||0}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Terkirim"})]})})})]})})]}),e.jsx(p,{sx:{borderRadius:3,boxShadow:"0 4px 16px rgba(150, 130, 219, 0.12)",border:"1px solid rgba(150, 130, 219, 0.08)"},children:e.jsxs(u,{sx:{p:0},children:[e.jsxs(o,{sx:{p:3,borderBottom:"1px solid rgba(150, 130, 219, 0.1)"},children:[e.jsx(i,{variant:"h6",fontWeight:600,color:"text.primary",className:"craft-heading",children:"Data Pengiriman"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:"Tracking dan status pengiriman order"})]}),e.jsx(ue,{children:e.jsxs(ge,{children:[e.jsx(be,{children:e.jsxs(H,{sx:{backgroundColor:"rgba(150, 130, 219, 0.05)"},children:[e.jsx(n,{sx:{fontWeight:600,color:"text.primary"},children:"ID Pengiriman"}),e.jsx(n,{sx:{fontWeight:600,color:"text.primary"},children:"Order ID"}),e.jsx(n,{sx:{fontWeight:600,color:"text.primary"},children:"Penerima"}),e.jsx(n,{sx:{fontWeight:600,color:"text.primary"},children:"Tujuan"}),e.jsx(n,{sx:{fontWeight:600,color:"text.primary"},children:"Kurir"}),e.jsx(n,{sx:{fontWeight:600,color:"text.primary"},children:"Status"}),e.jsx(n,{sx:{fontWeight:600,color:"text.primary"},children:"Tracking"}),e.jsx(n,{sx:{fontWeight:600,color:"text.primary"},children:"Aksi"})]})}),e.jsx(fe,{children:h.map(r=>e.jsxs(H,{hover:!0,children:[e.jsx(n,{sx:{fontWeight:500},children:r.id}),e.jsx(n,{children:r.orderId}),e.jsx(n,{children:r.recipient}),e.jsx(n,{children:r.destination}),e.jsx(n,{children:r.courier}),e.jsx(n,{children:e.jsx(F,{icon:Ie(r.status),label:Te(r.status),size:"small",color:Ce(r.status),sx:{fontWeight:500}})}),e.jsx(n,{children:r.trackingNumber?e.jsx(i,{variant:"body2",sx:{fontFamily:"monospace"},children:r.trackingNumber}):e.jsx(i,{variant:"body2",color:"text.secondary",children:"-"})}),e.jsx(n,{children:e.jsx(je,{title:"Lihat Detail",children:e.jsx(ne,{size:"small",color:"primary",children:e.jsx(ye,{fontSize:"small"})})})})]},r.id))})]})})]})})]})]})}export{Me as default};
