import{c as O,j as e,p as P,q as D,af as W,X as w,r as i,B as r,T as a,C as p,t as m,S as y}from"./index-Idy1NCQZ.js";import{o as A}from"./orderApi-Cky_adNE.js";import{u as L}from"./useCurrencyConversion-CyZkluwP.js";import{A as g}from"./Alert-Cw7awSGM.js";import{H as b}from"./Home-BPVXMe6a.js";import{C as B,a as _}from"./CardContent-5_xtjPDw.js";import{O as E}from"./Receipt-Rb_kuaO4.js";const H=O(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle");function G(){P();const x=D(),h=W(),[u]=w(),{formatPrice:v}=L(),o=u.get("order_id"),c=h.state?.orderId,s=o||c,[t,C]=i.useState(null),[I,d]=i.useState(!0),[f,l]=i.useState(null),k=async()=>{if(console.log("PaymentSuccessPage - Order ID Debug:",{orderIdFromUrl:o,orderIdFromState:c,finalOrderId:s,locationState:h.state,searchParams:Object.fromEntries(u.entries())}),!s){l("Order ID tidak ditemukan dalam URL atau state"),d(!1);return}try{d(!0),console.log("Fetching order with ID:",s);const n=await A.getOrderById(s);n.success?C(n.data):l("Order tidak ditemukan di server")}catch(n){console.error("Error fetching order:",n),l(n.response?.data?.error||"Gagal memuat order")}finally{d(!1)}};i.useEffect(()=>{k()},[s]);const S=()=>{s&&x(`/orders/${s}`)},j=()=>{x("/")};return I?e.jsx(r,{sx:{minHeight:"100vh",py:8,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(a,{children:"Memuat..."})}):f||!t?e.jsx(r,{sx:{minHeight:"100vh",py:8},children:e.jsxs(p,{maxWidth:"md",children:[e.jsx(g,{severity:"error",sx:{maxWidth:600,mx:"auto"},children:f||"Order tidak ditemukan"}),e.jsx(r,{sx:{mt:2,p:2,backgroundColor:"#f5f5f5",borderRadius:1},children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Debug Info:"}),e.jsx("br",{}),"Order ID from URL: ",o||"null",e.jsx("br",{}),"Order ID from State: ",c||"null",e.jsx("br",{}),"Final Order ID: ",s||"null"]})}),e.jsx(r,{sx:{textAlign:"center",mt:4},children:e.jsx(m,{variant:"contained",onClick:j,startIcon:e.jsx(b,{}),children:"Kembali ke Beranda"})})]})}):e.jsx(r,{sx:{minHeight:"100vh",py:8},children:e.jsxs(p,{maxWidth:"md",children:[e.jsxs(r,{sx:{textAlign:"center",mb:6},children:[e.jsx(H,{sx:{fontSize:80,color:"success.main",mb:3,animation:"pulse 2s infinite","@keyframes pulse":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(1.05)"},"100%":{transform:"scale(1)"}}}}),e.jsx(a,{variant:"h3",fontWeight:700,color:"success.main",sx:{mb:2},children:"Pembayaran Berhasil!"}),e.jsx(a,{variant:"h6",color:"text.secondary",children:"Terima kasih atas pembelian Anda. Pesanan Anda sedang diproses."})]}),e.jsx(B,{sx:{mb:4},children:e.jsxs(_,{sx:{p:4},children:[e.jsx(a,{variant:"h6",fontWeight:600,sx:{mb:3},children:"Detail Pesanan"}),e.jsxs(y,{spacing:2,children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Order ID:"}),e.jsx(a,{variant:"body1",fontWeight:500,children:t.id})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Total Pembayaran:"}),e.jsx(a,{variant:"h6",fontWeight:600,color:"primary.main",children:v(Number(t.total_amount)+Number(t.shipping_cost))})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Status:"}),e.jsx(a,{variant:"body1",fontWeight:500,color:t.payment_status==="paid"?"success.main":"warning.main",children:t.payment_status==="paid"?"Lunas":t.payment_status})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Tanggal Pesanan:"}),e.jsx(a,{variant:"body1",fontWeight:500,children:new Date(t.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})}),e.jsx(g,{severity:"info",sx:{mb:4},children:e.jsx(a,{variant:"body2",children:'Kami akan mengirimkan email konfirmasi dan detail pengiriman ke alamat email Anda. Anda juga dapat melacak status pesanan di halaman "Pesanan Saya".'})}),e.jsxs(y,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"center",children:[e.jsx(m,{variant:"contained",size:"large",startIcon:e.jsx(E,{}),onClick:S,sx:{px:4,py:1.5,borderRadius:2,fontWeight:600},children:"Lihat Detail Pesanan"}),e.jsx(m,{variant:"outlined",size:"large",startIcon:e.jsx(b,{}),onClick:j,sx:{px:4,py:1.5,borderRadius:2,fontWeight:600},children:"Kembali ke Beranda"})]})]})})}export{G as default};
