import{q as L,aB as $,r as n,j as e,af as z,C as F,am as k,aA as H,T as t,B as o,t as v,x as N,A as W,w,I as G}from"./index-aASFK1tJ.js";import{p as D}from"./productApi-DfFG5Fjc.js";import{B as K}from"./Breadcrumbs-Bs6AffS5.js";import{H as U}from"./Home-DeLk4JvE.js";import{R as _}from"./Refresh-BTo0viWr.js";import{A as q}from"./Alert-CgLHgHYO.js";import{T as M,a as O,b as J,c as p,d as r,e as Q}from"./TableRow-DZR2Yq0b.js";import{T as V}from"./Tooltip-C8ajhJyt.js";import{R as X}from"./Restore-OaPFa_FI.js";import{T as Y}from"./TablePagination-CUzsGYiU.js";import"./Popper-t_rnaNgN.js";import"./KeyboardArrowRight-DiyQ7MuP.js";import"./LastPage-CcfBlTVB.js";function me(){const l=L(),{showNotification:j}=$(),[d,C]=n.useState([]),[c,f]=n.useState(!0),[y,h]=n.useState(null),[m,b]=n.useState(0),[x,I]=n.useState(10),[P,S]=n.useState(0),u=async a=>{try{f(!0),h(null);const s=await D.getDeletedProducts({page:(m||0)+1,limit:x,...a});if(s.success)C(s.data),S(s.pagination?.total||0);else throw new Error("Failed to fetch deleted products")}catch(s){h(s.message||"Gagal memuat data produk yang dihapus")}finally{f(!1)}};n.useEffect(()=>{u()},[m,x]);const T=async(a,s)=>{if(window.confirm(`Apakah Anda yakin ingin memulihkan produk "${s}"?`))try{const i=await D.restoreProduct(a);if(i.success)j({type:"success",message:"Produk berhasil dipulihkan"}),await u();else throw new Error(i.message||"Failed to restore product")}catch(i){j({type:"error",message:i.message||"Gagal memulihkan produk"})}},R=(a,s)=>{b(s)},A=a=>{I(parseInt(a.target.value,10)),b(0)},B=()=>{u()},E=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a);return c&&d.length===0?e.jsx(z,{message:"Memuat data produk yang dihapus..."}):e.jsxs(F,{maxWidth:!1,children:[e.jsxs(K,{sx:{mb:3},children:[e.jsxs(k,{component:"button",variant:"body2",onClick:()=>l("/admin"),sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(U,{fontSize:"small"}),"Dashboard"]}),e.jsxs(k,{component:"button",variant:"body2",onClick:()=>l("/admin/products"),sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(H,{fontSize:"small"}),"Produk"]}),e.jsx(t,{variant:"body2",color:"textPrimary",children:"Produk Dihapus"})]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(o,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Produk yang Dihapus"}),e.jsx(t,{variant:"body1",color:"textSecondary",children:"Kelola produk yang telah dihapus (soft delete)"})]}),e.jsxs(o,{sx:{display:"flex",gap:2},children:[e.jsx(v,{variant:"outlined",startIcon:e.jsx(_,{}),onClick:B,disabled:c,children:"Refresh"}),e.jsx(v,{variant:"outlined",onClick:()=>l("/admin/products"),children:"Kembali ke Produk"})]})]}),y&&e.jsx(q,{severity:"error",sx:{mb:3},onClose:()=>h(null),children:y}),e.jsx(M,{component:N,children:e.jsxs(O,{children:[e.jsx(J,{children:e.jsxs(p,{children:[e.jsx(r,{children:"Gambar"}),e.jsx(r,{children:"Nama Produk"}),e.jsx(r,{children:"Kategori"}),e.jsx(r,{align:"right",children:"Harga"}),e.jsx(r,{align:"center",children:"Stok"}),e.jsx(r,{children:"Dibuat"}),e.jsx(r,{children:"Dihapus"}),e.jsx(r,{align:"center",children:"Aksi"})]})}),e.jsx(Q,{children:d.length===0?e.jsx(p,{children:e.jsx(r,{colSpan:8,align:"center",sx:{py:4},children:e.jsx(t,{variant:"body1",color:"textSecondary",children:"Tidak ada produk yang dihapus"})})}):d.map(a=>e.jsxs(p,{hover:!0,children:[e.jsx(r,{children:e.jsx(W,{variant:"rounded",sx:{width:40,height:40},children:a.name.charAt(0).toUpperCase()})}),e.jsx(r,{children:e.jsxs(o,{children:[e.jsx(t,{variant:"body1",fontWeight:"medium",children:a.name}),e.jsx(t,{variant:"body2",color:"textSecondary",children:a.description||"-"})]})}),e.jsx(r,{children:e.jsx(w,{label:a.category?.name||"Tidak ada kategori",size:"small",color:"primary",variant:"outlined"})}),e.jsx(r,{align:"right",children:e.jsx(t,{variant:"body1",fontWeight:"medium",children:E(a.price)})}),e.jsx(r,{align:"center",children:e.jsx(w,{label:a.stock,size:"small",color:a.stock>0?"success":"error",variant:a.stock>0?"filled":"outlined"})}),e.jsx(r,{children:e.jsx(t,{variant:"body2",children:new Date(a.created_at).toLocaleDateString("id-ID")})}),e.jsx(r,{children:e.jsx(t,{variant:"body2",color:"error",children:new Date(a.deleted_at).toLocaleDateString("id-ID")})}),e.jsx(r,{align:"center",children:e.jsx(V,{title:"Pulihkan Produk",children:e.jsx(G,{color:"primary",onClick:()=>T(a.id,a.name),disabled:c,children:e.jsx(X,{})})})})]},a.id))})]})}),P>0&&e.jsx(Y,{rowsPerPageOptions:[5,10,25,50],component:"div",count:P,rowsPerPage:x,page:m,onPageChange:R,onRowsPerPageChange:A,labelRowsPerPage:"Baris per halaman:",labelDisplayedRows:({from:a,to:s,count:g})=>`${a}-${s} dari ${g!==-1?g:`lebih dari ${s}`}`})]})}export{me as default};
