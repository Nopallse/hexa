import{r as n,j as e,T as p,B as l,R as P,b as g,i as R,h as C}from"./index-sM3j39aj.js";import{u as T,a as W,o as M,s as x,l as N}from"./schemas-BqhefqUI.js";import{a as z}from"./image-DkS5CVTc.js";import{C as A,a as E}from"./CardContent-Cj-kD625.js";import{A as G}from"./Alert-CTAf5yxJ.js";import{U as K}from"./CloudUpload-BJD0dHJG.js";import{D as V}from"./Delete-D01o1oo-.js";const _=M({name:x().min(1,"Nama kategori wajib diisi").min(2,"Nama kategori minimal 2 karakter").max(100,"Nama kategori maksimal 100 karakter"),description:x().max(500,"Deskripsi maksimal 500 karakter").optional().or(N("")),image:x().optional()});function $({category:r,isLoading:t=!1,error:h,onSubmit:y,onCancel:f,mode:i}){const[c,b]=n.useState(null),[B,j]=n.useState(null),[s,J]=n.useState(!1),[o,k]=n.useState(null),{register:v,handleSubmit:F,formState:{errors:m},reset:I,setValue:S}=T({resolver:W(_),defaultValues:{name:"",description:"",image:""}});n.useEffect(()=>{r&&i==="edit"&&(I({name:r.name,description:r.description||"",image:r.image||""}),k(r.image||null))},[r,i,I]);const U=async d=>{const a=d.target.files?.[0];if(!a)return;if(!a.type.startsWith("image/")){alert("File harus berupa gambar");return}if(a.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}b(a);const u=new FileReader;u.onloadend=()=>{j(u.result)},u.readAsDataURL(a)},w=()=>{b(null),j(null),k(null),S("image","")},D=async d=>{const a={name:d.name,description:d.description||void 0};c?a._imageFile=c:!o&&i==="edit"&&(a._removeImage=!0),await y(a)};return e.jsx(A,{children:e.jsxs(E,{children:[e.jsx(p,{variant:"h5",gutterBottom:!0,fontWeight:"bold",children:i==="create"?"Tambah Kategori Baru":"Edit Kategori"}),h&&e.jsx(G,{severity:"error",sx:{mb:3},children:h}),e.jsxs(l,{component:"form",onSubmit:F(D),sx:{mt:3},children:[e.jsxs(l,{sx:{mb:3},children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Gambar Kategori"}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(P,{src:B||(o?z(o):void 0),sx:{width:100,height:100},variant:"rounded"}),e.jsxs(l,{children:[e.jsxs(g,{component:"label",variant:"outlined",startIcon:e.jsx(K,{}),disabled:t||s,children:[s?"Uploading...":"Pilih Gambar",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:U})]}),(c||o)&&e.jsx(R,{onClick:w,disabled:t||s,color:"error",size:"small",sx:{ml:1},children:e.jsx(V,{})}),e.jsx(p,{variant:"caption",display:"block",sx:{mt:1,color:"text.secondary"},children:"Format: JPG, PNG, WebP (Max 5MB)"})]})]})]}),e.jsx(C,{...v("name"),label:"Nama Kategori",fullWidth:!0,margin:"normal",error:!!m.name,helperText:m.name?.message,disabled:t,placeholder:"Contoh: Boneka Rajutan"}),e.jsx(C,{...v("description"),label:"Deskripsi",fullWidth:!0,margin:"normal",multiline:!0,rows:4,error:!!m.description,helperText:m.description?.message,disabled:t,placeholder:"Deskripsi kategori (opsional)"}),e.jsxs(l,{sx:{display:"flex",gap:2,mt:4},children:[e.jsx(g,{type:"submit",variant:"contained",size:"large",disabled:t||s,sx:{minWidth:120},children:s?"Uploading...":t?i==="create"?"Menyimpan...":"Mengupdate...":i==="create"?"Simpan":"Update"}),f&&e.jsx(g,{variant:"outlined",size:"large",onClick:f,disabled:t||s,children:"Batal"})]})]})]})})}export{$ as C};
