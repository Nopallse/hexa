import{c as ue,j as e,p as he,O as pe,q as fe,A as be,ai as je,r as o,B as n,ae as w,C as ge,T as t,x as ye,aj as z,ab as Q,t as l,F as ve,D as m,ak as Ce,al as Ae,Y,Z,$ as v,am as Se}from"./index-Idy1NCQZ.js";import{a as p}from"./addressApi-CFRSAVlm.js";import{T as _e,a as X}from"./Tabs-HJ5cjxDE.js";import{A as P}from"./Alert-Cw7awSGM.js";import{G as i}from"./Grid-CQRQWomO.js";import{C as E,a as D}from"./CardContent-5_xtjPDw.js";import{A as ke}from"./Avatar-BJbDu4KS.js";import{E as Ie}from"./Edit-BAZVwRWz.js";import{C as We}from"./Cancel-CDYfLkbp.js";import{C as Re}from"./CalendarToday-B6VuUJf4.js";import{A as ee}from"./Add-CFf7PY0f.js";import{D as Te,a as we,b as ze}from"./DialogTitle-BkdEpzB-.js";import"./KeyboardArrowRight-BxK0sE0P.js";const Pe=ue(e.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");function se(d){const{children:C,value:a,index:f,...g}=d;return e.jsx("div",{role:"tabpanel",hidden:a!==f,id:`profile-tabpanel-${f}`,"aria-labelledby":`profile-tab-${f}`,...g,children:a===f&&e.jsx(n,{sx:{py:3},children:C})})}function ae(d){return{id:`profile-tab-${d}`,"aria-controls":`profile-tabpanel-${d}`}}function Ve(){const d=he(),C=pe(d.breakpoints.down("md"));fe();const{user:a,updateProfile:f}=be();je();const[g,re]=o.useState(0),[u,M]=o.useState(!1),[B,G]=o.useState(!1),[O,A]=o.useState(null),[$,S]=o.useState(null),[K,_]=o.useState([]),[te,H]=o.useState(!1),[N,b]=o.useState(null),[ne,y]=o.useState(!1),[k,L]=o.useState(null),[h,I]=o.useState({address_line:"",city:"",province:"",postal_code:"",is_primary:!1}),[F,U]=o.useState(!1),[V,c]=o.useState(null),[j,W]=o.useState({full_name:"",email:"",phone:"",gender:"",date_of_birth:""});o.useEffect(()=>{a&&W({full_name:a.full_name||"",email:a.email||"",phone:a.phone||"",gender:a.gender||"",date_of_birth:a.date_of_birth||""})},[a]),o.useEffect(()=>{(async()=>{try{H(!0),b(null);const r=await p.getAddresses();r.success?_(r.data):b(r.error||"Gagal memuat alamat")}catch(r){b(r.message||"Gagal memuat alamat")}finally{H(!1)}})()},[]);const R=s=>r=>{W(x=>({...x,[s]:r.target.value}))},ie=s=>r=>{W(x=>({...x,[s]:r.target.value}))},oe=async()=>{try{G(!0),A(null),S(null),await f(j),S("Profil berhasil diperbarui"),M(!1)}catch(s){A(s.message||"Gagal memperbarui profil")}finally{G(!1)}},le=()=>{a&&W({full_name:a.full_name||"",email:a.email||"",phone:a.phone||"",gender:a.gender||"",date_of_birth:a.date_of_birth||""}),M(!1),A(null),S(null)},de=(s,r)=>{re(r)},J=()=>{L(null),I({address_line:"",city:"",province:"",postal_code:"",is_primary:!1}),c(null),y(!0)},ce=s=>{L(s),I({address_line:s.address_line,city:s.city,province:s.province,postal_code:s.postal_code,is_primary:s.is_primary}),c(null),y(!0)},T=s=>r=>{I(x=>({...x,[s]:r.target.value}))},xe=async()=>{try{if(U(!0),c(null),k){const s=await p.updateAddress(k.id,h);if(s.success){const r=await p.getAddresses();r.success&&_(r.data),y(!1)}else c(s.error||"Gagal memperbarui alamat")}else{const s=await p.createAddress(h);if(s.success){const r=await p.getAddresses();r.success&&_(r.data),y(!1)}else c(s.error||"Gagal menambah alamat")}}catch(s){c(s.message||"Terjadi kesalahan")}finally{U(!1)}},q=()=>{y(!1),L(null),c(null)},me=async s=>{if(window.confirm("Apakah Anda yakin ingin menghapus alamat ini?"))try{const r=await p.deleteAddress(s.id);if(r.success){const x=await p.getAddresses();x.success&&_(x.data)}else b(r.error||"Gagal menghapus alamat")}catch(r){b(r.message||"Gagal menghapus alamat")}};return a?e.jsxs(ge,{maxWidth:"xl",sx:{py:4},children:[e.jsxs(n,{sx:{mb:4},children:[e.jsx(t,{variant:"h4",component:"h1",sx:{fontWeight:600,color:"text.primary",mb:1},children:"Akun Saya"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Kelola informasi pribadi dan alamat Anda"})]}),e.jsx(ye,{elevation:0,sx:{mb:3,borderRadius:2,border:`1px solid ${d.palette.grey[200]}`,overflow:"hidden"},children:e.jsxs(_e,{value:g,onChange:de,variant:C?"scrollable":"standard",scrollButtons:C?"auto":!1,allowScrollButtonsMobile:!0,sx:{borderBottom:`1px solid ${d.palette.grey[200]}`,"& .MuiTab-root":{textTransform:"none",fontWeight:500,fontSize:"1rem",py:2,px:3,minHeight:"auto","&.Mui-selected":{fontWeight:600,color:"primary.main"}},"& .MuiTabs-indicator":{height:3,borderRadius:"3px 3px 0 0"}},children:[e.jsx(X,{icon:e.jsx(z,{sx:{fontSize:"1.2rem",mb:.5}}),iconPosition:"start",label:"Profil",...ae(0)}),e.jsx(X,{icon:e.jsx(Q,{sx:{fontSize:"1.2rem",mb:.5}}),iconPosition:"start",label:"Alamat",...ae(1)})]})}),e.jsx(se,{value:g,index:0,children:e.jsxs(n,{children:[$&&e.jsx(P,{severity:"success",sx:{mb:3,borderRadius:2},onClose:()=>S(null),children:$}),O&&e.jsx(P,{severity:"error",sx:{mb:3,borderRadius:2},onClose:()=>A(null),children:O}),e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{item:!0,xs:12,md:4,children:e.jsx(E,{sx:{borderRadius:2,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsxs(D,{sx:{p:3,textAlign:"center"},children:[e.jsx(ke,{sx:{width:120,height:120,mx:"auto",mb:2,bgcolor:"primary.main",fontSize:"3rem"},children:e.jsx(z,{sx:{fontSize:"3rem"}})}),e.jsx(t,{variant:"h6",sx:{fontWeight:600,mb:1,color:"text.primary"},children:a.full_name||"Nama belum diisi"}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:a.email}),e.jsx(l,{variant:"outlined",startIcon:e.jsx(Ie,{}),onClick:()=>M(!0),disabled:u,sx:{borderRadius:2,textTransform:"none",fontWeight:500},children:"Edit Profil"})]})})}),e.jsx(i,{item:!0,xs:12,md:8,children:e.jsx(E,{sx:{borderRadius:2,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsxs(D,{sx:{p:3},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(t,{variant:"h6",sx:{fontWeight:600,color:"text.primary"},children:"Informasi Pribadi"}),u&&e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(l,{variant:"outlined",startIcon:e.jsx(We,{}),onClick:le,disabled:B,sx:{borderRadius:2,textTransform:"none",fontWeight:500},children:"Batal"}),e.jsx(l,{variant:"contained",startIcon:e.jsx(Pe,{}),onClick:oe,disabled:B,sx:{borderRadius:2,textTransform:"none",fontWeight:500,backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:B?e.jsx(w,{size:20}):"Simpan"})]})]}),e.jsx(ve,{sx:{mb:3}}),e.jsxs(i,{container:!0,spacing:3,children:[e.jsxs(i,{item:!0,xs:12,sm:6,children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(z,{sx:{fontSize:"1rem",mr:1,color:"text.secondary"}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Nama Lengkap"})]}),u?e.jsx(m,{fullWidth:!0,value:j.full_name,onChange:R("full_name"),variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}):e.jsx(t,{variant:"body1",sx:{fontWeight:500},children:a.full_name||"Belum diisi"})]}),e.jsxs(i,{item:!0,xs:12,sm:6,children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ce,{sx:{fontSize:"1rem",mr:1,color:"text.secondary"}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Email"})]}),u?e.jsx(m,{fullWidth:!0,value:j.email,onChange:R("email"),variant:"outlined",size:"small",type:"email",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}):e.jsx(t,{variant:"body1",sx:{fontWeight:500},children:a.email})]}),e.jsxs(i,{item:!0,xs:12,sm:6,children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ae,{sx:{fontSize:"1rem",mr:1,color:"text.secondary"}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Nomor Telepon"})]}),u?e.jsx(m,{fullWidth:!0,value:j.phone,onChange:R("phone"),variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}):e.jsx(t,{variant:"body1",sx:{fontWeight:500},children:a.phone||"Belum diisi"})]}),e.jsxs(i,{item:!0,xs:12,sm:6,children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(z,{sx:{fontSize:"1rem",mr:1,color:"text.secondary"}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Jenis Kelamin"})]}),u?e.jsx(Y,{fullWidth:!0,size:"small",children:e.jsxs(Z,{value:j.gender,onChange:ie("gender"),sx:{borderRadius:2},children:[e.jsx(v,{value:"",children:"Pilih Jenis Kelamin"}),e.jsx(v,{value:"male",children:"Laki-laki"}),e.jsx(v,{value:"female",children:"Perempuan"})]})}):e.jsx(t,{variant:"body1",sx:{fontWeight:500},children:a.gender==="male"?"Laki-laki":a.gender==="female"?"Perempuan":"Belum diisi"})]}),e.jsxs(i,{item:!0,xs:12,sm:6,children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Re,{sx:{fontSize:"1rem",mr:1,color:"text.secondary"}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Tanggal Lahir"})]}),u?e.jsx(m,{fullWidth:!0,value:j.date_of_birth,onChange:R("date_of_birth"),variant:"outlined",size:"small",type:"date",InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}):e.jsx(t,{variant:"body1",sx:{fontWeight:500},children:a.date_of_birth?new Date(a.date_of_birth).toLocaleDateString("id-ID"):"Belum diisi"})]})]})]})})})]})]})}),e.jsx(se,{value:g,index:1,children:e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(t,{variant:"h6",sx:{fontWeight:600,color:"text.primary"},children:"Alamat Saya"}),e.jsx(l,{variant:"contained",startIcon:e.jsx(ee,{}),onClick:J,sx:{borderRadius:2,textTransform:"none",fontWeight:500,backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"Tambah Alamat"})]}),N&&e.jsx(P,{severity:"error",sx:{mb:3,borderRadius:2},onClose:()=>b(null),children:N}),te?e.jsx(n,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(w,{})}):K.length===0?e.jsx(E,{sx:{borderRadius:2,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsxs(D,{sx:{p:4,textAlign:"center"},children:[e.jsx(Q,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(t,{variant:"h6",sx:{fontWeight:600,color:"text.primary",mb:1},children:"Belum Ada Alamat"}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Tambahkan alamat untuk memudahkan proses checkout"}),e.jsx(l,{variant:"contained",startIcon:e.jsx(ee,{}),onClick:J,sx:{borderRadius:2,textTransform:"none",fontWeight:500,backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"Tambah Alamat Pertama"})]})}):e.jsx(i,{container:!0,spacing:3,children:K.map(s=>e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(E,{sx:{borderRadius:2,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",height:"100%",display:"flex",flexDirection:"column"},children:e.jsxs(D,{sx:{p:3,flexGrow:1},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsx(t,{variant:"h6",sx:{fontWeight:600,color:"text.primary"},children:"Alamat Utama"}),s.is_primary&&e.jsx(n,{sx:{backgroundColor:"primary.main",color:"white",px:1,py:.5,borderRadius:1,fontSize:"0.75rem",fontWeight:600},children:"Default"})]}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:s.address_line}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:[s.city,", ",s.province," ",s.postal_code]}),e.jsxs(n,{sx:{display:"flex",gap:1,mt:"auto"},children:[e.jsx(l,{variant:"outlined",size:"small",onClick:()=>ce(s),sx:{borderRadius:2,textTransform:"none",fontWeight:500,fontSize:"0.75rem"},children:"Edit"}),!s.is_primary&&e.jsx(l,{variant:"outlined",color:"error",size:"small",onClick:()=>me(s),sx:{borderRadius:2,textTransform:"none",fontWeight:500,fontSize:"0.75rem"},children:"Hapus"})]})]})})},s.id))})]})}),e.jsxs(Te,{open:ne,onClose:q,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsx(we,{children:e.jsx(t,{variant:"h6",fontWeight:600,children:k?"Edit Alamat":"Tambah Alamat Baru"})}),e.jsxs(ze,{sx:{p:3},children:[V&&e.jsx(P,{severity:"error",sx:{mb:3,borderRadius:2},onClose:()=>c(null),children:V}),e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"Alamat Lengkap",value:h.address_line,onChange:T("address_line"),variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(m,{fullWidth:!0,label:"Kota",value:h.city,onChange:T("city"),variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(m,{fullWidth:!0,label:"Provinsi",value:h.province,onChange:T("province"),variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(m,{fullWidth:!0,label:"Kode Pos",value:h.postal_code,onChange:T("postal_code"),variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(Y,{fullWidth:!0,children:[e.jsx(Se,{children:"Status Alamat"}),e.jsxs(Z,{value:h.is_primary?"primary":"secondary",onChange:s=>I(r=>({...r,is_primary:s.target.value==="primary"})),sx:{borderRadius:2},children:[e.jsx(v,{value:"primary",children:"Alamat Utama"}),e.jsx(v,{value:"secondary",children:"Alamat Tambahan"})]})]})})]}),e.jsxs(n,{sx:{display:"flex",gap:2,mt:4,justifyContent:"flex-end"},children:[e.jsx(l,{variant:"outlined",onClick:q,disabled:F,sx:{borderRadius:2,textTransform:"none",fontWeight:500},children:"Batal"}),e.jsx(l,{variant:"contained",onClick:xe,disabled:F,sx:{borderRadius:2,textTransform:"none",fontWeight:500,backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:F?e.jsx(w,{size:20}):k?"Update":"Simpan"})]})]})]})]}):e.jsx(n,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(w,{})})}export{Ve as default};
