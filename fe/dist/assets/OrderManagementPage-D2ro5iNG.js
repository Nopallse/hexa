import{j as e,x as y,T as u,B as W,w as U,I as q,p as M,r as l,E as Q,X,a4 as Y,ay as J,a5 as Z,a6 as v,t as ee,W as ae,q as te,aB as se,Y as re,af as ne,C as ie}from"./index-sTH-7xwR.js";import{a as le}from"./orderApi-c1n6mRUP.js";import{u as oe}from"./useCurrencyConversion-CYsls9be.js";import{T as A,a as F,b as R,c as P,d as a,e as _}from"./TableRow-De_r54Cd.js";import{S as b}from"./Skeleton-Bbwws2TW.js";import{T as de}from"./Tooltip-BMDYRwfD.js";import{V as ce}from"./Visibility-n9a2iNTS.js";import{G as k}from"./Grid-CNdzohqz.js";import{A as ue}from"./Alert-B0PlZ22k.js";import{T as he,a as me}from"./Tabs-kXK3MNS0.js";import{T as xe}from"./TablePagination-CtdkWwE4.js";import"./Popper-BdUOu1lY.js";import"./KeyboardArrowRight-BUfzKkmK.js";import"./LastPage-3gzg-XfO.js";const je=s=>{switch(s){case"belum_bayar":return"warning";case"dikemas":return"primary";case"dikirim":return"info";case"diterima":return"success";case"dibatalkan":return"error";default:return"default"}},ge=s=>{switch(s){case"belum_bayar":return"Belum Bayar";case"dikemas":return"Dikemas";case"dikirim":return"Dikirim";case"diterima":return"Diterima";case"dibatalkan":return"Dibatalkan";default:return s}};function be({orders:s,isLoading:m,onView:c}){const{formatPrice:x}=oe(),o=t=>new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return m&&s.length===0?e.jsx(A,{component:y,elevation:0,sx:{borderRadius:2,border:"1px solid",borderColor:"divider"},children:e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(P,{children:[e.jsx(a,{children:"ID Pesanan"}),e.jsx(a,{children:"Pelanggan"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Total"}),e.jsx(a,{children:"Tanggal"}),e.jsx(a,{align:"right",children:"Aksi"})]})}),e.jsx(_,{children:[...Array(5)].map((t,d)=>e.jsxs(P,{children:[e.jsx(a,{children:e.jsx(b,{})}),e.jsx(a,{children:e.jsx(b,{})}),e.jsx(a,{children:e.jsx(b,{})}),e.jsx(a,{children:e.jsx(b,{})}),e.jsx(a,{children:e.jsx(b,{})}),e.jsx(a,{align:"right",children:e.jsx(b,{})})]},d))})]})}):s.length===0?e.jsx(y,{elevation:0,sx:{p:4,textAlign:"center",borderRadius:2,border:"1px solid",borderColor:"divider"},children:e.jsx(u,{variant:"body1",color:"textSecondary",children:"Tidak ada pesanan ditemukan"})}):e.jsx(e.Fragment,{children:e.jsx(A,{component:y,elevation:0,sx:{borderRadius:2,border:"1px solid",borderColor:"divider"},children:e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(P,{children:[e.jsx(a,{children:"ID Pesanan"}),e.jsx(a,{children:"Pelanggan"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Total"}),e.jsx(a,{children:"Tanggal"}),e.jsx(a,{align:"right",children:"Aksi"})]})}),e.jsx(_,{children:s.map(t=>e.jsxs(P,{hover:!0,children:[e.jsx(a,{children:e.jsxs(u,{variant:"body2",fontWeight:500,children:["#",t.id.slice(-8).toUpperCase()]})}),e.jsx(a,{children:e.jsxs(W,{children:[e.jsx(u,{variant:"body2",fontWeight:500,children:t.user?.full_name||"N/A"}),e.jsx(u,{variant:"caption",color:"textSecondary",children:t.user?.email||"N/A"})]})}),e.jsx(a,{children:e.jsx(U,{label:ge(t.status),size:"small",color:je(t.status),variant:"outlined",sx:{fontSize:"0.75rem",height:24,fontWeight:500}})}),e.jsx(a,{children:e.jsx(u,{variant:"body2",fontWeight:600,children:x((Number(t.total_amount)||0)+(Number(t.shipping_cost)||0))})}),e.jsx(a,{children:e.jsx(u,{variant:"body2",color:"textSecondary",children:o(t.created_at)})}),e.jsx(a,{align:"right",children:e.jsx(de,{title:"Lihat Detail",children:e.jsx(q,{size:"small",onClick:()=>c(t),sx:{color:"primary.main"},children:e.jsx(ce,{fontSize:"small"})})})})]},t.id))})]})})})}function pe({onFilterChange:s,loading:m=!1,initialFilters:c}){const x=M(),[o,t]=l.useState({search:"",payment_status:"",...c}),[d,T]=l.useState(null);l.useEffect(()=>{c&&t(r=>({...r,...c}))},[c]);const S=(r,g)=>{const h={...o,[r]:g};t(h),s(h)},p=r=>{const g={...o,search:r};t(g),d&&clearTimeout(d);const h=setTimeout(()=>{s(g)},500);T(h)},f=()=>{const r={search:"",payment_status:""};t(r),s(r)};l.useEffect(()=>()=>{d&&clearTimeout(d)},[d]);const j=o.search||o.payment_status;return e.jsx(y,{elevation:0,sx:{p:2,mb:3,borderRadius:2,border:`1px solid ${x.palette.grey[200]}`},children:e.jsxs(k,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(k,{item:!0,xs:12,md:4,children:e.jsx(Q,{fullWidth:!0,size:"small",placeholder:"Cari ID pesanan, nama, atau email...",value:o.search||"",onChange:r=>p(r.target.value),InputProps:{startAdornment:e.jsx(X,{sx:{mr:1,color:"text.secondary"}})},disabled:m})}),e.jsx(k,{item:!0,xs:12,md:3,children:e.jsxs(Y,{fullWidth:!0,size:"small",children:[e.jsx(J,{children:"Status Pembayaran"}),e.jsxs(Z,{value:o.payment_status||"",onChange:r=>S("payment_status",r.target.value),label:"Status Pembayaran",disabled:m,children:[e.jsx(v,{value:"",children:"Semua"}),e.jsx(v,{value:"unpaid",children:"Belum Dibayar"}),e.jsx(v,{value:"paid",children:"Sudah Dibayar"}),e.jsx(v,{value:"failed",children:"Gagal Bayar"}),e.jsx(v,{value:"refunded",children:"Dikembalikan"})]})]})}),e.jsx(k,{item:!0,xs:12,md:2,children:e.jsx(ee,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(ae,{}),onClick:f,disabled:m||!j,sx:{height:40},children:"Hapus Filter"})})]})})}function fe(s){return{id:`order-tab-${s}`,"aria-controls":`order-tabpanel-${s}`}}function _e(){const s=te(),{showNotification:m}=se(),c=M(),x=re(c.breakpoints.down("md")),[o,t]=l.useState([]),[d,T]=l.useState(!0),[S,p]=l.useState(null),[f,j]=l.useState(0),[r,g]=l.useState(10),[h,$]=l.useState(0),[z,E]=l.useState(0),[D,B]=l.useState({}),I=[{label:"Semua",value:""},{label:"Belum Bayar",value:"belum_bayar"},{label:"Dikemas",value:"dikemas"},{label:"Dikirim",value:"dikirim"},{label:"Diterima",value:"diterima"},{label:"Dibatalkan",value:"dibatalkan"}],w=l.useMemo(()=>D,[D]),O=async i=>{try{T(!0),p(null);const n=await le.getAllOrders({page:(f||0)+1,limit:r,...i});if(n.success)t(n.data),$(n.pagination?.total||0);else throw new Error("Failed to fetch orders")}catch(n){p(n.response?.data?.error||n.message||"Gagal memuat data pesanan")}finally{T(!1)}};l.useEffect(()=>{O(w)},[f,r,w]);const L=(i,n)=>{E(n);const C=I[n].value;B(K=>({...K,status:C})),j(0)},N=i=>{B(i),j(0)},G=i=>{s(`/admin/orders/${i.id}`)},H=(i,n)=>{j(n)},V=i=>{g(parseInt(i.target.value,10)),j(0)};return d&&o.length===0?e.jsx(ne,{message:"Memuat data pesanan..."}):e.jsxs(ie,{maxWidth:!1,children:[e.jsxs(W,{sx:{mb:4},children:[e.jsx(u,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Kelola Pesanan"}),e.jsx(u,{variant:"body1",color:"textSecondary",children:"Kelola dan lacak semua pesanan pelanggan"})]}),S&&e.jsx(ue,{severity:"error",sx:{mb:3},onClose:()=>p(null),children:S}),e.jsx(y,{elevation:0,sx:{mb:3,borderRadius:2,border:`1px solid ${c.palette.grey[200]}`},children:e.jsx(he,{value:z,onChange:L,variant:x?"scrollable":"standard",scrollButtons:x?"auto":!1,allowScrollButtonsMobile:!0,sx:{borderBottom:`1px solid ${c.palette.grey[200]}`,"& .MuiTab-root":{textTransform:"none",fontWeight:500,fontSize:"1rem",py:2,px:3,minHeight:"auto","&.Mui-selected":{fontWeight:600,color:"primary.main"}},"& .MuiTabs-indicator":{height:3,borderRadius:"3px 3px 0 0"}},children:I.map((i,n)=>e.jsx(me,{label:i.label,...fe(n)},i.value))})}),e.jsx(pe,{onFilterChange:N,loading:d,initialFilters:w}),e.jsx(be,{orders:o,isLoading:d,onView:G}),h>0&&e.jsx(xe,{rowsPerPageOptions:[5,10,25,50],component:"div",count:h,rowsPerPage:r,page:f,onPageChange:H,onRowsPerPageChange:V,labelRowsPerPage:"Baris per halaman:",labelDisplayedRows:({from:i,to:n,count:C})=>`${i}-${n} dari ${C!==-1?C:`lebih dari ${n}`}`})]})}export{_e as default};
