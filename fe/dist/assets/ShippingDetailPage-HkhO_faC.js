import{p as Q,a8 as V,q as X,r as c,j as r,ag as Y,B as d,C as T,v as y,an as D,H as A,T as i,y as o,S as l,x as f,I as P,O as L,aq as Z,E as rr}from"./index-tvCmUXkA.js";import{s as N}from"./shippingApi-BleV1al2.js";import{u as er}from"./useCurrencyConversion-DM705tyN.js";import{A as p}from"./Alert-iJ2nvuQL.js";import{A as B}from"./ArrowBack-BROWJOPA.js";import{B as ir}from"./Breadcrumbs-BRY0wQO3.js";import{H as tr}from"./Home-FYrVyE1n.js";import{G as a}from"./Grid-CE62ACEJ.js";import{C as v,a as k}from"./CardContent-BO7gwO4c.js";import{T as U}from"./Tooltip-CRdXSvuP.js";import{O as E}from"./OpenInNew-wJc69th9.js";import{R as sr}from"./Refresh-RespFlYJ.js";import{S as ar,a as nr,b as or,R as cr}from"./RadioButtonUnchecked-DAZCd5uw.js";import{C as lr}from"./CheckCircle-CLjEyLHK.js";import{O as dr}from"./Receipt-CJT1sDb7.js";import"./useSlot-Dd61XFNI.js";import"./Popper-DMWFBkOI.js";const $=n=>{switch(n){case"delivered":return"success";case"in_transit":return"info";case"pending":return"warning";default:return"default"}},O=n=>{switch(n){case"delivered":return"Terkirim";case"in_transit":return"Dalam Perjalanan";case"pending":return"Menunggu Pengiriman";default:return n}};function Wr(){const n=Q(),{id:S}=V(),g=X(),{formatPrice:I}=er(),h=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),[e,G]=c.useState(null),[H,R]=c.useState(!0),[b,u]=c.useState(null),[x,W]=c.useState(!1),[t,K]=c.useState(null),[z,j]=c.useState(null),[w,F]=c.useState(!1),M=async()=>{if(S)try{R(!0),u(null);const s=await N.getShippingDetail(S);s.success&&s.data?G(s.data):u(s.error||"Gagal memuat data pengiriman")}catch(s){u(s.response?.data?.error||"Gagal memuat data pengiriman")}finally{R(!1)}},C=c.useCallback(async()=>{if(e?.tracking_number){W(!0),j(null);try{const s=await N.getTrackingInfo(e.tracking_number,e.courier?.toLowerCase());s.success?K(s):j(s.error||"Gagal mendapatkan informasi tracking")}catch(s){j(s.response?.data?.error||"Gagal mendapatkan informasi tracking")}finally{W(!1)}}},[e?.tracking_number,e?.courier]),q=(s,m)=>{const J=s?.toLowerCase();return{jne:"https://www.jne.co.id/id/tracking/tariff-and-service",jnt:"https://www.jet.co.id/track",sicepat:"https://www.sicepat.com/check-resi",pos:"https://www.posindonesia.co.id/tracking",anteraja:"https://anteraja.id/tracking",tiki:"https://tiki.id/tracking"}[J||""]||null};if(c.useEffect(()=>{M()},[S]),c.useEffect(()=>{e?.tracking_number&&!t&&!x&&C()},[e?.tracking_number,t,x,C]),H)return r.jsx(Y,{message:"Memuat data pengiriman..."});if(b&&!e)return r.jsx(d,{sx:{bgcolor:"grey.50",minHeight:"100vh",pb:4},children:r.jsxs(T,{maxWidth:"xl",sx:{py:4},children:[r.jsx(p,{severity:"error",sx:{mb:3},onClose:()=>u(null),children:b}),r.jsx(y,{startIcon:r.jsx(B,{}),onClick:()=>g("/admin/shipping"),sx:{borderRadius:2,fontWeight:500,color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:"action.hover"}},children:"Kembali ke Daftar Pengiriman"})]})});if(!e)return null;const _=e.tracking_number?q(e.courier,e.tracking_number):null;return r.jsx(d,{sx:{bgcolor:"grey.50",minHeight:"100vh",pb:4},children:r.jsxs(T,{maxWidth:"xl",sx:{py:4},children:[r.jsxs(ir,{sx:{mb:2},children:[r.jsxs(D,{component:"button",variant:"body2",onClick:()=>g("/admin"),sx:{display:"flex",alignItems:"center",textDecoration:"none",color:"text.secondary","&:hover":{color:"primary.main"}},children:[r.jsx(tr,{sx:{mr:.5,fontSize:"1rem"}}),"Dashboard"]}),r.jsxs(D,{component:"button",variant:"body2",onClick:()=>g("/admin/shipping"),sx:{display:"flex",alignItems:"center",textDecoration:"none",color:"text.secondary","&:hover":{color:"primary.main"}},children:[r.jsx(A,{sx:{mr:.5,fontSize:"1rem"}}),"Pengiriman"]}),r.jsxs(i,{variant:"body2",color:"text.primary",fontWeight:500,children:["#",e.id.slice(-8).toUpperCase()]})]}),r.jsx(y,{startIcon:r.jsx(B,{}),onClick:()=>g("/admin/shipping"),sx:{mb:3,borderRadius:2,fontWeight:500,color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:"action.hover"}},children:"Kembali ke Daftar Pengiriman"}),r.jsx(o,{elevation:0,sx:{mb:3,borderRadius:3,overflow:"hidden",background:`linear-gradient(135deg, ${n.palette.primary.main}15 0%, ${n.palette.primary.light}08 100%)`,border:`1px solid ${n.palette.divider}`},children:r.jsx(d,{sx:{p:4,pb:3},children:r.jsx(l,{direction:{xs:"column",md:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",md:"center"},spacing:3,children:r.jsxs(d,{sx:{flex:1},children:[r.jsxs(l,{direction:"row",alignItems:"center",spacing:2,sx:{mb:1.5},children:[r.jsxs(i,{variant:"h4",fontWeight:700,sx:{color:"text.primary"},children:["Shipping #",e.id.slice(-8).toUpperCase()]}),r.jsx(f,{label:O(e.shipping_status),color:$(e.shipping_status),size:"small",sx:{height:28,fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.5}})]}),e.created_at&&r.jsxs(i,{variant:"body2",color:"text.secondary",children:["Dibuat pada ",h(e.created_at)]})]})})})}),b&&r.jsx(p,{severity:"error",sx:{mb:3},onClose:()=>u(null),children:b}),r.jsxs(a,{container:!0,spacing:3,children:[r.jsx(a,{item:!0,xs:12,lg:8,children:r.jsxs(l,{spacing:3,children:[r.jsx(v,{elevation:0,sx:{borderRadius:3,border:`1px solid ${n.palette.divider}`},children:r.jsxs(k,{sx:{p:3},children:[r.jsxs(l,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:3},children:[r.jsxs(l,{direction:"row",alignItems:"center",spacing:1.5,children:[r.jsx(A,{color:"primary"}),r.jsx(i,{variant:"h6",fontWeight:700,children:"Informasi Pengiriman"})]}),e.tracking_number&&r.jsxs(l,{direction:"row",spacing:1,children:[e.courier&&_&&r.jsx(U,{title:"Buka di website kurir",children:r.jsx(P,{size:"small",onClick:()=>{_&&window.open(_,"_blank")},sx:{color:"primary.main"},children:r.jsx(E,{fontSize:"small"})})}),r.jsx(U,{title:"Refresh tracking",children:r.jsx(P,{size:"small",onClick:C,disabled:x,sx:{color:"primary.main"},children:x?r.jsx(L,{size:20}):r.jsx(sr,{fontSize:"small"})})})]})]}),r.jsxs(a,{container:!0,spacing:2,children:[r.jsx(a,{item:!0,xs:12,sm:6,children:r.jsxs(o,{elevation:0,sx:{p:2,bgcolor:"grey.50",borderRadius:2},children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Status"}),r.jsx(f,{label:O(e.shipping_status),color:$(e.shipping_status),size:"small",sx:{fontWeight:600}})]})}),r.jsx(a,{item:!0,xs:12,sm:6,children:r.jsxs(o,{elevation:0,sx:{p:2,bgcolor:"grey.50",borderRadius:2},children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Kurir"}),r.jsx(i,{variant:"body1",fontWeight:600,children:e.courier||"N/A"})]})}),e.tracking_number&&r.jsx(a,{item:!0,xs:12,sm:6,children:r.jsxs(o,{elevation:0,sx:{p:2,bgcolor:"primary.light",borderRadius:2},children:[r.jsx(i,{variant:"caption",color:"primary.dark",sx:{fontSize:"0.75rem",mb:.5,display:"block",fontWeight:600},children:"Nomor Resi"}),r.jsx(i,{variant:"body1",fontWeight:700,color:"primary.main",sx:{fontFamily:"monospace"},children:e.tracking_number})]})}),e.estimated_delivery&&r.jsx(a,{item:!0,xs:12,sm:6,children:r.jsxs(o,{elevation:0,sx:{p:2,bgcolor:"grey.50",borderRadius:2},children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Estimasi Sampai"}),r.jsx(i,{variant:"body1",fontWeight:600,children:h(e.estimated_delivery)})]})}),e.shipped_at&&r.jsx(a,{item:!0,xs:12,sm:6,children:r.jsxs(o,{elevation:0,sx:{p:2,bgcolor:"grey.50",borderRadius:2},children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Tanggal Dikirim"}),r.jsx(i,{variant:"body1",fontWeight:600,children:h(e.shipped_at)})]})}),e.delivered_at&&r.jsx(a,{item:!0,xs:12,sm:6,children:r.jsxs(o,{elevation:0,sx:{p:2,bgcolor:"grey.50",borderRadius:2},children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Tanggal Diterima"}),r.jsx(i,{variant:"body1",fontWeight:600,children:h(e.delivered_at)})]})}),e.tracking_number&&r.jsx(a,{item:!0,xs:12,children:r.jsxs(y,{variant:"outlined",onClick:()=>F(!w),sx:{textTransform:"none",borderRadius:2,mt:1},fullWidth:!0,children:[w?"Sembunyikan":"Lihat"," Detail Tracking"]})})]}),w&&r.jsxs(d,{sx:{mt:4,pt:3,borderTop:`1px solid ${n.palette.divider}`},children:[z&&r.jsx(p,{severity:"warning",sx:{mb:3,borderRadius:2},onClose:()=>j(null),children:z}),x&&!t&&r.jsx(d,{sx:{display:"flex",justifyContent:"center",py:4},children:r.jsx(L,{})}),t?.data?.history&&Array.isArray(t.data.history)&&t.data.history.length>0&&r.jsxs(d,{children:[r.jsx(i,{variant:"subtitle1",fontWeight:700,sx:{mb:3},children:"Riwayat Tracking"}),r.jsx(ar,{orientation:"vertical",sx:{"& .MuiStepLabel-root":{alignItems:"flex-start"}},children:t.data.history.map((s,m)=>r.jsx(nr,{active:m===0,completed:m>0,children:r.jsxs(or,{StepIconComponent:()=>r.jsx(d,{sx:{width:24,height:24,borderRadius:"50%",bgcolor:m===0?"primary.main":"grey.300",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:m===0?r.jsx(lr,{sx:{fontSize:20}}):r.jsx(cr,{sx:{fontSize:20}})}),children:[r.jsx(i,{variant:"body2",fontWeight:600,sx:{mb:.5},children:s.status?s.status.charAt(0).toUpperCase()+s.status.slice(1):"Update"}),s.note&&r.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:s.note}),s.updated_at&&r.jsx(i,{variant:"caption",color:"text.secondary",children:h(s.updated_at)})]})},m))})]}),t?.data&&!(t?.data?.history&&Array.isArray(t.data.history)&&t.data.history.length>0)&&r.jsxs(d,{children:[t.data.waybill_id&&r.jsxs(o,{elevation:0,sx:{p:2,mb:2,bgcolor:"grey.50",borderRadius:2},children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Waybill ID"}),r.jsx(i,{variant:"body1",fontWeight:600,sx:{fontFamily:"monospace"},children:t.data.waybill_id})]}),t.data.status&&r.jsxs(o,{elevation:0,sx:{p:2,mb:2,bgcolor:"grey.50",borderRadius:2},children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Status"}),r.jsx(f,{label:t.data.status,color:"primary",size:"small",sx:{fontWeight:600}})]}),t.data.courier&&r.jsxs(o,{elevation:0,sx:{p:2,mb:2,bgcolor:"grey.50",borderRadius:2},children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Kurir"}),r.jsxs(i,{variant:"body1",fontWeight:600,children:[t.data.courier.company||"N/A"," ",t.data.courier.name?`- ${t.data.courier.name}`:""]})]}),t.data.link&&r.jsx(y,{variant:"outlined",startIcon:r.jsx(E,{}),onClick:()=>window.open(t.data.link,"_blank"),fullWidth:!0,sx:{textTransform:"none",borderRadius:2,mb:2},children:"Buka Tracking di Biteship"}),r.jsx(p,{severity:"info",sx:{borderRadius:2},children:"Riwayat tracking belum tersedia"})]}),t&&!t?.data&&r.jsx(p,{severity:"info",sx:{borderRadius:2},children:"Informasi tracking belum tersedia"}),!t&&!x&&r.jsx(p,{severity:"info",sx:{borderRadius:2},children:"Klik tombol refresh untuk memuat detail tracking"})]})]})}),e.order&&r.jsx(v,{elevation:0,sx:{borderRadius:3,border:`1px solid ${n.palette.divider}`},children:r.jsxs(k,{sx:{p:3},children:[r.jsxs(l,{direction:"row",alignItems:"center",spacing:1.5,sx:{mb:3},children:[r.jsx(dr,{color:"primary"}),r.jsx(i,{variant:"h6",fontWeight:700,children:"Informasi Pesanan"})]}),r.jsxs(a,{container:!0,spacing:2,children:[r.jsxs(a,{item:!0,xs:12,sm:6,children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Order ID"}),r.jsxs(i,{variant:"body1",fontWeight:600,children:["#",e.order.id.slice(-8).toUpperCase()]})]}),r.jsxs(a,{item:!0,xs:12,sm:6,children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Status Order"}),r.jsx(f,{label:e.order.status,size:"small",color:"primary",sx:{fontWeight:600}})]}),r.jsxs(a,{item:!0,xs:12,sm:6,children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Total Amount"}),r.jsx(i,{variant:"body1",fontWeight:600,children:I(parseFloat(e.order.total_amount||0))})]}),r.jsxs(a,{item:!0,xs:12,sm:6,children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Shipping Cost"}),r.jsx(i,{variant:"body1",fontWeight:600,children:I(parseFloat(e.order.shipping_cost||0))})]})]})]})})]})}),r.jsx(a,{item:!0,xs:12,lg:4,children:r.jsxs(l,{spacing:3,children:[e.order?.user&&r.jsx(v,{elevation:0,sx:{position:"sticky",top:24,borderRadius:3,border:`1px solid ${n.palette.divider}`},children:r.jsxs(k,{sx:{p:3},children:[r.jsxs(l,{direction:"row",alignItems:"center",spacing:1.5,sx:{mb:3},children:[r.jsx(Z,{color:"primary"}),r.jsx(i,{variant:"h6",fontWeight:700,children:"Informasi Pelanggan"})]}),e.order.user&&r.jsxs(a,{container:!0,spacing:2,children:[r.jsxs(a,{item:!0,xs:12,children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Nama"}),r.jsx(i,{variant:"body1",fontWeight:600,children:e.order.user.full_name||"N/A"})]}),r.jsxs(a,{item:!0,xs:12,children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Email"}),r.jsx(i,{variant:"body1",children:e.order.user.email||"N/A"})]}),e.order.user.phone&&r.jsxs(a,{item:!0,xs:12,children:[r.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5,display:"block"},children:"Telepon"}),r.jsx(i,{variant:"body1",children:e.order.user.phone})]})]})]})}),e.order?.address&&r.jsx(v,{elevation:0,sx:{position:"sticky",top:e.order?.user?400:24,borderRadius:3,border:`1px solid ${n.palette.divider}`},children:r.jsxs(k,{sx:{p:3},children:[r.jsxs(l,{direction:"row",alignItems:"center",spacing:1.5,sx:{mb:2},children:[r.jsx(rr,{color:"primary"}),r.jsx(i,{variant:"subtitle1",fontWeight:700,children:"Alamat Pengiriman"})]}),r.jsxs(o,{elevation:0,sx:{p:2,bgcolor:"grey.50",borderRadius:2},children:[e.order.address.recipient_name&&r.jsx(i,{variant:"body1",fontWeight:600,sx:{mb:.5},children:e.order.address.recipient_name}),r.jsx(i,{variant:"body1",fontWeight:600,sx:{mb:.5},children:e.order.address.address_line||"N/A"}),r.jsxs(i,{variant:"body2",color:"text.secondary",children:[e.order.address.city||"N/A",", ",e.order.address.province||"N/A"," ",e.order.address.postal_code||"N/A"]})]})]})})]})})]})]})})}export{Wr as default};
