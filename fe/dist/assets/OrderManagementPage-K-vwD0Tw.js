import{j as e,x as p,T as c,B as F,w as U,I as q,p as M,r as l,a4 as Q,al as X,a5 as Z,a6 as j,t as J,X as Y,q as ee,aB as ae,Z as te,ag as re,C as se}from"./index-CLjvjqZT.js";import{a as ne}from"./orderApi-BQi_9tph.js";import{u as ie}from"./useCurrencyConversion-DcYLh6Vv.js";import{T as R,a as I,b as _,c as S,d as a,e as A}from"./TableRow-5-DPG7g8.js";import{S as x}from"./Skeleton-BN8PhGVI.js";import{T as le}from"./Tooltip-BrgySCds.js";import{V as oe}from"./Visibility-Cu8UOJov.js";import{G as P}from"./Grid-Yhwe_G7n.js";import{A as de}from"./Alert-Cs6zeJMp.js";import{T as ce,a as ue}from"./Tabs-CLwtFENm.js";import{T as he}from"./TablePagination-ByuaW9VP.js";import"./Popper-Bu6D8dQx.js";import"./useSlot-CDkgSjON.js";import"./KeyboardArrowRight-BMzCiM98.js";import"./LastPage-DTDVOSKy.js";const me=r=>{switch(r){case"belum_bayar":return"warning";case"dikemas":return"primary";case"dikirim":return"info";case"diterima":return"success";case"dibatalkan":return"error";default:return"default"}},xe=r=>{switch(r){case"belum_bayar":return"Belum Bayar";case"dikemas":return"Dikemas";case"dikirim":return"Dikirim";case"diterima":return"Diterima";case"dibatalkan":return"Dibatalkan";default:return r}};function ge({orders:r,isLoading:g,onView:o}){const{formatPrice:m}=ie(),d=t=>new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return g&&r.length===0?e.jsx(R,{component:p,elevation:0,sx:{borderRadius:2,border:"1px solid",borderColor:"divider"},children:e.jsxs(I,{children:[e.jsx(_,{children:e.jsxs(S,{children:[e.jsx(a,{children:"ID Pesanan"}),e.jsx(a,{children:"Pelanggan"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Total"}),e.jsx(a,{children:"Tanggal"}),e.jsx(a,{align:"right",children:"Aksi"})]})}),e.jsx(A,{children:[...Array(5)].map((t,u)=>e.jsxs(S,{children:[e.jsx(a,{children:e.jsx(x,{})}),e.jsx(a,{children:e.jsx(x,{})}),e.jsx(a,{children:e.jsx(x,{})}),e.jsx(a,{children:e.jsx(x,{})}),e.jsx(a,{children:e.jsx(x,{})}),e.jsx(a,{align:"right",children:e.jsx(x,{})})]},u))})]})}):r.length===0?e.jsx(p,{elevation:0,sx:{p:4,textAlign:"center",borderRadius:2,border:"1px solid",borderColor:"divider"},children:e.jsx(c,{variant:"body1",color:"textSecondary",children:"Tidak ada pesanan ditemukan"})}):e.jsx(e.Fragment,{children:e.jsx(R,{component:p,elevation:0,sx:{borderRadius:2,border:"1px solid",borderColor:"divider"},children:e.jsxs(I,{children:[e.jsx(_,{children:e.jsxs(S,{children:[e.jsx(a,{children:"ID Pesanan"}),e.jsx(a,{children:"Pelanggan"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Total"}),e.jsx(a,{children:"Tanggal"}),e.jsx(a,{align:"right",children:"Aksi"})]})}),e.jsx(A,{children:r.map(t=>e.jsxs(S,{hover:!0,children:[e.jsx(a,{children:e.jsxs(c,{variant:"body2",fontWeight:500,children:["#",t.id.slice(-8).toUpperCase()]})}),e.jsx(a,{children:e.jsxs(F,{children:[e.jsx(c,{variant:"body2",fontWeight:500,children:t.user?.full_name||"N/A"}),e.jsx(c,{variant:"caption",color:"textSecondary",children:t.user?.email||"N/A"})]})}),e.jsx(a,{children:e.jsx(U,{label:xe(t.status),size:"small",color:me(t.status),variant:"outlined",sx:{fontSize:"0.75rem",height:24,fontWeight:500}})}),e.jsx(a,{children:e.jsx(c,{variant:"body2",fontWeight:600,children:m((Number(t.total_amount)||0)+(Number(t.shipping_cost)||0))})}),e.jsx(a,{children:e.jsx(c,{variant:"body2",color:"textSecondary",children:d(t.created_at)})}),e.jsx(a,{align:"right",children:e.jsx(le,{title:"Lihat Detail",children:e.jsx(q,{size:"small",onClick:()=>o(t),sx:{color:"primary.main"},children:e.jsx(oe,{fontSize:"small"})})})})]},t.id))})]})})})}function be({onFilterChange:r,loading:g=!1,initialFilters:o}){const m=M(),[d,t]=l.useState({payment_status:"",...o});l.useEffect(()=>{o&&t(i=>({...i,...o}))},[o]);const u=(i,b)=>{const h={...d,[i]:b};t(h),r(h)},f=()=>{const i={payment_status:""};t(i),r(i)},v=d.payment_status;return e.jsx(p,{elevation:0,sx:{p:2,mb:3,borderRadius:2,border:`1px solid ${m.palette.grey[200]}`},children:e.jsxs(P,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(P,{item:!0,xs:12,md:3,children:e.jsxs(Q,{fullWidth:!0,size:"small",children:[e.jsx(X,{children:"Status Pembayaran"}),e.jsxs(Z,{value:d.payment_status||"",onChange:i=>u("payment_status",i.target.value),label:"Status Pembayaran",disabled:g,children:[e.jsx(j,{value:"",children:"Semua"}),e.jsx(j,{value:"unpaid",children:"Belum Dibayar"}),e.jsx(j,{value:"paid",children:"Sudah Dibayar"}),e.jsx(j,{value:"failed",children:"Gagal Bayar"}),e.jsx(j,{value:"refunded",children:"Dikembalikan"})]})]})}),e.jsx(P,{item:!0,xs:12,md:2,children:e.jsx(J,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(Y,{}),onClick:f,disabled:g||!v,sx:{height:40},children:"Reset"})})]})})}function je(r){return{id:`order-tab-${r}`,"aria-controls":`order-tabpanel-${r}`}}function Ae(){const r=ee(),{showNotification:g}=ae(),o=M(),m=te(o.breakpoints.down("md")),[d,t]=l.useState([]),[u,f]=l.useState(!0),[v,i]=l.useState(null),[b,h]=l.useState(0),[T,W]=l.useState(10),[k,$]=l.useState(0),[O,z]=l.useState(0),[w,D]=l.useState({}),B=[{label:"Semua",value:""},{label:"Belum Bayar",value:"belum_bayar"},{label:"Dikemas",value:"dikemas"},{label:"Dikirim",value:"dikirim"},{label:"Diterima",value:"diterima"},{label:"Dibatalkan",value:"dibatalkan"}],C=l.useMemo(()=>w,[w]),L=async n=>{try{f(!0),i(null);const s=await ne.getAllOrders({page:(b||0)+1,limit:T,...n});if(s.success)t(s.data),$(s.pagination?.total||0);else throw new Error("Failed to fetch orders")}catch(s){i(s.response?.data?.error||s.message||"Gagal memuat data pesanan")}finally{f(!1)}};l.useEffect(()=>{L(C)},[b,T,C]);const E=(n,s)=>{z(s);const y=B[s].value;D(K=>({...K,status:y})),h(0)},N=n=>{D(n),h(0)},G=n=>{r(`/admin/orders/${n.id}`)},V=(n,s)=>{h(s)},H=n=>{W(parseInt(n.target.value,10)),h(0)};return u&&d.length===0?e.jsx(re,{message:"Memuat data pesanan..."}):e.jsxs(se,{maxWidth:!1,children:[e.jsxs(F,{sx:{mb:4},children:[e.jsx(c,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Kelola Pesanan"}),e.jsx(c,{variant:"body1",color:"textSecondary",children:"Kelola dan lacak semua pesanan pelanggan"})]}),v&&e.jsx(de,{severity:"error",sx:{mb:3},onClose:()=>i(null),children:v}),e.jsx(p,{elevation:0,sx:{mb:3,borderRadius:2,border:`1px solid ${o.palette.grey[200]}`},children:e.jsx(ce,{value:O,onChange:E,variant:m?"scrollable":"standard",scrollButtons:m?"auto":!1,allowScrollButtonsMobile:!0,sx:{borderBottom:`1px solid ${o.palette.grey[200]}`,"& .MuiTab-root":{textTransform:"none",fontWeight:500,fontSize:"1rem",py:2,px:3,minHeight:"auto","&.Mui-selected":{fontWeight:600,color:"primary.main"}},"& .MuiTabs-indicator":{height:3,borderRadius:"3px 3px 0 0"}},children:B.map((n,s)=>e.jsx(ue,{label:n.label,...je(s)},n.value))})}),e.jsx(be,{onFilterChange:N,loading:u,initialFilters:C}),e.jsx(ge,{orders:d,isLoading:u,onView:G}),k>0&&e.jsx(he,{rowsPerPageOptions:[5,10,25,50],component:"div",count:k,rowsPerPage:T,page:b,onPageChange:V,onRowsPerPageChange:H,labelRowsPerPage:"Baris per halaman:",labelDisplayedRows:({from:n,to:s,count:y})=>`${n}-${s} dari ${y!==-1?y:`lebih dari ${s}`}`})]})}export{Ae as default};
