import{c as A,j as e,g as N,a as G,r as b,u as J,_ as Y,i as P,s as Q,k as X,l as D,m as Z,V as ee,W as re,p as M,B as x,T as h,I as T,t as _,a9 as $,ad as L,S as R,w as ae,ae as B,q,ah as te,C as oe}from"./index-CLjvjqZT.js";import{u as H}from"./useCurrencyConversion-DcYLh6Vv.js";import{a as ne}from"./image-CeHRN-zl.js";import{D as ie,a as se,b as ce}from"./DialogTitle-D4zLwdK6.js";import{C as le}from"./Close-ncvFNPV-.js";import{D as de}from"./DialogContentText-HqByA2bt.js";import{D as he}from"./DialogActions-CDfJ26Do.js";import{C as xe}from"./CheckCircle-Dgb9bYPy.js";import{I as pe}from"./Info-tH7nK7KY.js";import{E as ue}from"./Error-CviQ74bM.js";import{C as O,a as U}from"./CardContent-Dqpv-NXF.js";import{A as W}from"./Alert-Cs6zeJMp.js";import{S as me}from"./SwitchBase-BbVYm7cH.js";import{A as ge}from"./Avatar-B6RLlSql.js";import{D as fe}from"./Delete-aajim2By.js";import{A as be}from"./Add-DNYdkQit.js";import{S as je}from"./Skeleton-BN8PhGVI.js";import{O as ye}from"./ShoppingBag-UWhR5iH-.js";import"./useSlot-CDkgSjON.js";const ve=A(e.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Ce=A(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),ke=A(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Se(r){return G("MuiCheckbox",r)}const E=N("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Ie=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],we=r=>{const{classes:t,indeterminate:s,color:m,size:y}=r,g={root:["root",s&&"indeterminate",`color${D(m)}`,`size${D(y)}`]},p=Z(g,Se,t);return P({},t,p)},ze=Q(me,{shouldForwardProp:r=>ee(r)||r==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(r,t)=>{const{ownerState:s}=r;return[t.root,s.indeterminate&&t.indeterminate,t[`size${D(s.size)}`],s.color!=="default"&&t[`color${D(s.color)}`]]}})(({theme:r,ownerState:t})=>P({color:(r.vars||r).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:r.vars?`rgba(${t.color==="default"?r.vars.palette.action.activeChannel:r.vars.palette[t.color].mainChannel} / ${r.vars.palette.action.hoverOpacity})`:re.alpha(t.color==="default"?r.palette.action.active:r.palette[t.color].main,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${E.checked}, &.${E.indeterminate}`]:{color:(r.vars||r).palette[t.color].main},[`&.${E.disabled}`]:{color:(r.vars||r).palette.action.disabled}})),_e=e.jsx(Ce,{}),We=e.jsx(ve,{}),Re=e.jsx(ke,{}),Ae=b.forwardRef(function(t,s){var m,y;const g=J({props:t,name:"MuiCheckbox"}),{checkedIcon:p=_e,color:i="primary",icon:v=We,indeterminate:l=!1,indeterminateIcon:j=Re,inputProps:C,size:f="medium",className:w}=g,z=Y(g,Ie),S=l?j:v,u=l?j:p,I=P({},g,{color:i,indeterminate:l,size:f}),c=we(I);return e.jsx(ze,P({type:"checkbox",inputProps:P({"data-indeterminate":l},C),icon:b.cloneElement(S,{fontSize:(m=S.props.fontSize)!=null?m:f}),checkedIcon:b.cloneElement(u,{fontSize:(y=u.props.fontSize)!=null?y:f}),ownerState:I,ref:s,className:X(c.root,w)},z,{classes:c}))}),Pe=A(e.jsx("path",{d:"M5 13h14v-2H5zm-2 4h14v-2H3zM7 7v2h14V7z"}),"ClearAll"),Be=A(e.jsx("path",{d:"M19 13H5v-2h14z"}),"Remove"),De=A(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning");function V({open:r,onClose:t,onConfirm:s,title:m,message:y,confirmText:g="Ya",cancelText:p="Batal",variant:i="warning",confirmColor:v="primary",loading:l=!1}){M();const j=()=>{switch(i){case"error":return e.jsx(ue,{sx:{color:"error.main",fontSize:40}});case"info":return e.jsx(pe,{sx:{color:"info.main",fontSize:40}});case"success":return e.jsx(xe,{sx:{color:"success.main",fontSize:40}});case"warning":default:return e.jsx(De,{sx:{color:"warning.main",fontSize:40}})}},C=()=>{if(v!=="primary")return v;switch(i){case"error":return"error";case"warning":return"warning";case"success":return"success";case"info":default:return"primary"}};return e.jsxs(ie,{open:r,onClose:l?void 0:t,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.12)"}},children:[e.jsxs(se,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",pb:2,pt:3,px:3},children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:2},children:[j(),e.jsx(h,{variant:"h6",fontWeight:600,children:m||"Konfirmasi"})]}),!l&&e.jsx(T,{onClick:t,size:"small",sx:{color:"text.secondary","&:hover":{backgroundColor:"action.hover"}},children:e.jsx(le,{})})]}),e.jsx(ce,{sx:{px:3,pb:2},children:e.jsx(de,{sx:{color:"text.primary",fontSize:"1rem",lineHeight:1.6,mb:1},children:y})}),e.jsxs(he,{sx:{px:3,pb:3,gap:1},children:[e.jsx(_,{onClick:t,disabled:l,variant:"outlined",sx:{minWidth:100,borderRadius:2,textTransform:"none",fontWeight:600,borderColor:"divider",color:"text.primary","&:hover":{borderColor:"primary.main",backgroundColor:"action.hover"}},children:p}),e.jsx(_,{onClick:s,disabled:l,variant:"contained",color:C(),sx:{minWidth:100,borderRadius:2,textTransform:"none",fontWeight:600},children:l?"Memproses...":g})]})]})}function F({item:r,onUpdate:t,onRemove:s,selected:m=!1,onSelectChange:y,selectable:g=!1}){const p=M(),[i,v]=b.useState(r.quantity),[l,j]=b.useState(null),[C,f]=b.useState(!1),{formatPrice:w}=H(),{updateQuantity:z,removeItem:S}=$();b.useEffect(()=>{v(r.quantity)},[r.quantity]);const u=r.product_variant.product.deleted_at!==null,I=o=>{const d=typeof o=="string"?parseFloat(o):o;return w(d)},c=async o=>{if(!(o<1||o>r.product_variant.stock))try{j(null),await z(r.id,o),v(o),await t(),B.success("Jumlah item berhasil diupdate",{duration:2e3,position:"bottom-right"})}catch(d){console.error("Error updating cart item:",d);const K=d.response?.data?.error||"Gagal mengupdate quantity";j(K),B.error(K,{duration:3e3,position:"bottom-right"})}},n=()=>{f(!0)},a=async()=>{try{j(null),f(!1),await S(r.id),await s(),B.success("Item berhasil dihapus dari keranjang",{duration:2e3,position:"bottom-right"})}catch(o){console.error("Error removing cart item:",o);const d=o.response?.data?.error||"Gagal menghapus item";j(d),B.error(d,{duration:3e3,position:"bottom-right"})}},k=r.product_variant.display_image||r.product_variant.image||r.product_variant.product.product_images?.find(o=>o.is_primary)?.image_name||r.product_variant.product.product_images?.[0]?.image_name;return e.jsxs(O,{sx:{mb:2,border:u?`1px solid ${p.palette.error.main}`:"none",opacity:u?.6:1,borderRadius:2,boxShadow:u?`0 2px 8px ${p.palette.error.main}20`:"0 1px 3px rgba(0,0,0,0.1)",transition:"all 0.2s ease","&:hover":{boxShadow:u?`0 4px 12px ${p.palette.error.main}30`:"0 2px 8px rgba(0,0,0,0.15)"}},children:[e.jsxs(U,{sx:{p:3},children:[u&&e.jsx(W,{severity:"error",sx:{mb:3,borderRadius:3,"& .MuiAlert-message":{fontWeight:600}},children:"Produk ini sudah tidak tersedia"}),l&&e.jsx(W,{severity:"error",sx:{mb:3,borderRadius:3,"& .MuiAlert-message":{fontWeight:600}},onClose:()=>j(null),children:l}),e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:3},children:[g&&e.jsx(x,{sx:{flexShrink:0},children:e.jsx(Ae,{checked:m,onChange:o=>y?.(r.id,o.target.checked),disabled:u,sx:{color:"primary.main","&.Mui-checked":{color:"primary.main"}}})}),e.jsx(x,{sx:{flexShrink:0},children:e.jsx(ge,{src:ne(k),alt:r.product_variant.product.name,sx:{width:80,height:80,borderRadius:2,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},variant:"rounded",children:e.jsx(L,{sx:{fontSize:32}})})}),e.jsxs(x,{sx:{flex:1,minWidth:0},children:[e.jsx(h,{variant:"h6",fontWeight:600,sx:{mb:1,color:"text.primary",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:1.3,fontSize:"1rem"},title:r.product_variant.product.name,children:r.product_variant.product.name}),r.product_variant.variant_options&&r.product_variant.variant_options.length>0&&e.jsx(R,{direction:"row",spacing:.5,sx:{mb:1,flexWrap:"wrap"},children:r.product_variant.variant_options.map((o,d)=>e.jsx(ae,{label:`${o.option_value}`,size:"small",variant:"outlined",sx:{fontSize:"0.7rem",height:20,borderColor:"primary.main",color:"primary.main","& .MuiChip-label":{px:1}}},d))}),e.jsxs(h,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.75rem"},children:["Stok: ",u?"Tidak tersedia":`${r.product_variant.stock} unit`]})]}),e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:2,flexShrink:0},children:[e.jsxs(x,{sx:{textAlign:"right",minWidth:100},children:[e.jsx(h,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.5},children:I(parseFloat(r.product_variant.price))}),e.jsx(h,{variant:"h6",color:"primary.main",fontWeight:700,sx:{fontSize:"1rem"},children:I(parseFloat(r.product_variant.price)*i)})]}),e.jsxs(x,{sx:{display:"flex",alignItems:"center",backgroundColor:"grey.50",borderRadius:2,p:.5,gap:.5},children:[e.jsx(T,{onClick:i===1?n:()=>c(i-1),disabled:u,size:"small",sx:{width:28,height:28,borderRadius:1,backgroundColor:i===1?"error.main":"white",color:i===1?"white":"text.primary",boxShadow:"0 1px 2px rgba(0,0,0,0.1)","&:hover":{backgroundColor:i===1?"error.dark":"primary.light",color:i===1?"white":"primary.main"},"&:disabled":{opacity:.5,backgroundColor:"grey.200"}},children:i===1?e.jsx(fe,{sx:{fontSize:14}}):e.jsx(Be,{sx:{fontSize:14}})}),e.jsx(h,{variant:"body2",fontWeight:600,sx:{minWidth:24,textAlign:"center",fontSize:"0.9rem"},children:i}),e.jsx(T,{onClick:()=>c(i+1),disabled:i>=r.product_variant.stock||u,size:"small",sx:{width:28,height:28,borderRadius:1,backgroundColor:"white",color:"text.primary",boxShadow:"0 1px 2px rgba(0,0,0,0.1)","&:hover":{backgroundColor:"primary.light",color:"primary.main"},"&:disabled":{opacity:.5,backgroundColor:"grey.200"}},children:e.jsx(be,{sx:{fontSize:14}})})]})]})]})]}),e.jsx(V,{open:C,onClose:()=>f(!1),onConfirm:a,title:"Hapus dari Keranjang",message:`Apakah Anda yakin ingin menghapus "${r.product_variant.product.name}" dari keranjang?`,confirmText:"Hapus",cancelText:"Batal",variant:"warning",confirmColor:"error"})]})}function Me({items:r,onCartCleared:t,selectedItems:s=new Set}){M();const m=q(),[y,g]=b.useState(!1),[p,i]=b.useState(!1),{formatPrice:v}=H(),{clearCart:l}=$(),j=n=>{const a=typeof n=="string"?parseFloat(n):n;return v(a)},C=()=>{i(!0)},f=async()=>{try{g(!0),i(!1),await l(),t()}catch(n){console.error("Error clearing cart:",n),alert(n.response?.data?.error||"Gagal mengosongkan keranjang")}finally{g(!1)}},w=()=>{try{if(s.size===0){alert("Pilih minimal satu item untuk checkout");return}const n=Array.from(s);m("/checkout",{state:{selectedCartItemIds:n}})}catch(n){console.error("Error navigating to checkout:",n)}},z=r.filter(n=>n.product_variant.product.deleted_at===null),S=r.filter(n=>n.product_variant.product.deleted_at!==null),u=z.filter(n=>s.has(n.id)),I=u.reduce((n,a)=>n+a.quantity,0),c=u.reduce((n,a)=>n+parseFloat(a.product_variant.price)*a.quantity,0);return e.jsxs(O,{sx:{position:"sticky",top:24,borderRadius:2,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"none"},children:[e.jsxs(U,{sx:{p:3},children:[e.jsx(h,{variant:"h6",fontWeight:600,sx:{mb:3,color:"text.primary"},children:"Ringkasan Belanja"}),e.jsxs(R,{spacing:2,children:[e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:2,px:2,backgroundColor:"grey.50",borderRadius:2},children:[e.jsxs(h,{variant:"body1",fontWeight:500,children:["Total Item (",I,")"]}),e.jsx(h,{variant:"h6",fontWeight:600,color:"primary.main",children:c>0?j(c):"Rp 0"})]}),S.length>0&&e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:1.5,px:2,backgroundColor:"error.light",borderRadius:2},children:[e.jsxs(h,{variant:"body2",color:"error.dark",fontWeight:500,children:["Item tidak tersedia (",S.length,")"]}),e.jsx(h,{variant:"body2",color:"error.dark",fontWeight:500,children:"Tidak dihitung"})]}),e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:2,px:2,backgroundColor:"primary.main",borderRadius:2,color:"white"},children:[e.jsx(h,{variant:"h6",fontWeight:600,children:"Total Belanja"}),e.jsx(h,{variant:"h5",fontWeight:700,children:v(c)})]}),e.jsxs(R,{spacing:1.5,children:[e.jsx(_,{variant:"contained",size:"large",startIcon:e.jsx(te,{}),onClick:w,disabled:s.size===0,fullWidth:!0,sx:{py:1.5,borderRadius:2,fontWeight:600,fontSize:"1rem",backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"},"&:disabled":{backgroundColor:"grey.300",color:"grey.500"}},children:s.size===0?"Pilih Item untuk Checkout":`Checkout (${s.size} item)`}),r.length>0&&e.jsx(_,{variant:"outlined",size:"large",startIcon:e.jsx(Pe,{}),onClick:C,disabled:y,fullWidth:!0,sx:{py:1.5,borderRadius:2,fontWeight:500,fontSize:"0.9rem",borderColor:"error.main",color:"error.main","&:hover":{backgroundColor:"error.light",borderColor:"error.dark"}},children:y?"Mengosongkan...":"Kosongkan Keranjang"})]})]})]}),e.jsx(V,{open:p,onClose:()=>i(!1),onConfirm:f,title:"Kosongkan Keranjang",message:"Apakah Anda yakin ingin mengosongkan seluruh keranjang? Semua item di keranjang akan dihapus.",confirmText:"Kosongkan",cancelText:"Batal",variant:"warning",confirmColor:"error",loading:y})]})}function rr(){M();const r=q(),{loading:t,error:s}=H(),{items:m,isLoading:y,error:g,syncWithServer:p}=$(),[i,v]=b.useState(null),[l,j]=b.useState(!0),[C,f]=b.useState(new Set);b.useEffect(()=>{(async()=>{await p(),j(!1)})()},[p]),b.useEffect(()=>{g&&v(g)},[g]);const w=async()=>{await p()},z=async()=>{await p()},S=async()=>{await p(),f(new Set)},u=(a,k)=>{f(o=>{const d=new Set(o);return k?d.add(a):d.delete(a),d})},I=a=>{if(a){const k=c.map(o=>o.id);f(new Set(k))}else f(new Set)},c=m.filter(a=>a.product_variant.product.deleted_at===null),n=m.filter(a=>a.product_variant.product.deleted_at!==null);return b.useEffect(()=>{if(!l&&c.length>0){const a=c.map(k=>k.id);f(k=>{if(k.size===0)return new Set(a);const o=new Set(k);return a.forEach(d=>{o.has(d)||o.add(d)}),Array.from(o).forEach(d=>{a.includes(d)||o.delete(d)}),o})}else c.length===0&&f(new Set)},[c.map(a=>a.id).join(","),l]),e.jsx(x,{sx:{minHeight:"100vh",py:4},children:e.jsxs(oe,{maxWidth:"xl",children:[e.jsxs(x,{sx:{mb:3},children:[e.jsx(h,{variant:"h4",fontWeight:600,sx:{mb:1,color:"text.primary"},children:"Keranjang Belanja"}),e.jsx(h,{variant:"body1",color:"text.secondary",children:"Kelola item di keranjang belanja Anda"})]}),t&&e.jsx(W,{severity:"info",sx:{mb:2},children:"Loading exchange rates..."}),s&&e.jsx(W,{severity:"warning",sx:{mb:2},children:"Failed to load exchange rates. Prices will be displayed in default currency."}),i&&e.jsx(W,{severity:"error",sx:{mb:4},onClose:()=>v(null),children:i}),e.jsxs(x,{sx:{display:"flex",flexDirection:{xs:"column",lg:"row"},gap:4,alignItems:"flex-start"},children:[e.jsx(x,{sx:{flex:1,minWidth:0,order:{xs:1,lg:1}},children:l?e.jsx(R,{spacing:2,children:[...Array(3)].map((a,k)=>e.jsx(je,{variant:"rectangular",height:120,sx:{borderRadius:2}},k))}):m.length===0?e.jsxs(x,{sx:{textAlign:"center",py:8,px:4,borderRadius:2,backgroundColor:"grey.50"},children:[e.jsx(L,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(h,{variant:"h5",fontWeight:600,sx:{mb:1,color:"text.primary"},children:"Keranjang Anda Kosong"}),e.jsx(h,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"Belum ada item di keranjang belanja Anda"}),e.jsxs(R,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"center",children:[e.jsx(_,{variant:"contained",size:"large",startIcon:e.jsx(ye,{}),onClick:()=>r("/products"),sx:{px:3,py:1.5,borderRadius:2,fontWeight:600},children:"Mulai Berbelanja"}),e.jsx(_,{variant:"outlined",size:"large",onClick:()=>r("/"),sx:{px:3,py:1.5,borderRadius:2,fontWeight:500},children:"Kembali ke Beranda"})]})]}):e.jsxs(R,{spacing:2,children:[c.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(h,{variant:"h6",fontWeight:600,sx:{color:"text.primary"},children:["Item Tersedia (",c.length,")"]}),e.jsx(_,{size:"small",onClick:()=>I(C.size!==c.length),sx:{textTransform:"none"},children:C.size===c.length?"Batal Pilih Semua":"Pilih Semua"})]}),c.map(a=>e.jsx(F,{item:a,onUpdate:w,onRemove:z,selected:C.has(a.id),onSelectChange:u,selectable:!0},a.id))]}),n.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(h,{variant:"h6",fontWeight:600,sx:{mb:2,color:"error.main"},children:["Item Tidak Tersedia (",n.length,")"]}),e.jsx(W,{severity:"warning",sx:{mb:2,borderRadius:2},children:"Beberapa item di keranjang Anda sudah tidak tersedia. Item ini akan diabaikan saat checkout."}),n.map(a=>e.jsx(F,{item:a,onUpdate:w,onRemove:z},a.id))]})]})}),m.length>0&&e.jsx(x,{sx:{width:{xs:"100%",lg:"400px"},flexShrink:0,order:{xs:2,lg:2}},children:e.jsx(Me,{items:m,onCartCleared:S,selectedItems:C})})]})]})})}export{rr as default};
