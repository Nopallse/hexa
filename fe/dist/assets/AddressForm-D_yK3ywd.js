import{aa as b,ab as A,u as j,r as h,j as t,B as S,S as f,h as u,b as g}from"./index-DVLSGWYZ.js";import{a as x}from"./addressApi-B6xq4cwq.js";import{A as C}from"./Alert-DeMLxQ5q.js";import{F as k}from"./FormControlLabel-BjLk7wiJ.js";import{S as W}from"./Switch-DZq5obZm.js";const q=b()(A((r,m)=>({addresses:[],loading:!1,error:null,setAddresses:a=>r({addresses:a}),addAddress:a=>r(i=>({addresses:[a,...i.addresses]})),updateAddress:(a,i)=>r(l=>({addresses:l.addresses.map(d=>d.id===a?{...d,...i}:d)})),removeAddress:a=>r(i=>({addresses:i.addresses.filter(l=>l.id!==a)})),setLoading:a=>r({loading:a}),setError:a=>r({error:a}),clearError:()=>r({error:null}),getPrimaryAddress:()=>{const{addresses:a}=m();return a.find(i=>i.is_primary)||null}}),{name:"address-storage",partialize:r=>({addresses:r.addresses})}));function B({address:r,onSuccess:m,onCancel:a}){const i=j(),[l,d]=h.useState(!1),[y,p]=h.useState(null),[e,_]=h.useState({address_line:r?.address_line||"",city:r?.city||"",province:r?.province||"",postal_code:r?.postal_code||"",is_primary:r?.is_primary||!1}),n=(s,o)=>{_(c=>({...c,[s]:o}))},v=async s=>{if(s.preventDefault(),!e.address_line.trim()||!e.city.trim()||!e.province.trim()||!e.postal_code.trim()){p("Semua field harus diisi");return}try{d(!0),p(null);let o;if(r){const c={address_line:e.address_line,city:e.city,province:e.province,postal_code:e.postal_code,is_primary:e.is_primary};o=await x.updateAddress(r.id,c)}else{const c={address_line:e.address_line,city:e.city,province:e.province,postal_code:e.postal_code,is_primary:e.is_primary};o=await x.addAddress(c)}o.success&&m(o.data)}catch(o){console.error("Error saving address:",o),p(o.response?.data?.error||"Gagal menyimpan alamat")}finally{d(!1)}};return t.jsxs(S,{component:"form",onSubmit:v,sx:{p:3,border:`1px solid ${i.palette.grey[300]}`,borderRadius:2,backgroundColor:"#f8f9fa"},children:[y&&t.jsx(C,{severity:"error",sx:{mb:3},onClose:()=>p(null),children:y}),t.jsxs(f,{spacing:3,children:[t.jsx(u,{label:"Alamat Lengkap",value:e.address_line,onChange:s=>n("address_line",s.target.value),fullWidth:!0,required:!0,multiline:!0,rows:3,placeholder:"Jl. Contoh No. 123, RT 01/RW 02"}),t.jsxs(f,{direction:{xs:"column",sm:"row"},spacing:2,children:[t.jsx(u,{label:"Kota",value:e.city,onChange:s=>n("city",s.target.value),fullWidth:!0,required:!0,placeholder:"Jakarta Pusat"}),t.jsx(u,{label:"Provinsi",value:e.province,onChange:s=>n("province",s.target.value),fullWidth:!0,required:!0,placeholder:"DKI Jakarta"})]}),t.jsx(u,{label:"Kode Pos",value:e.postal_code,onChange:s=>n("postal_code",s.target.value),fullWidth:!0,required:!0,placeholder:"10270"}),t.jsx(k,{control:t.jsx(W,{checked:e.is_primary,onChange:s=>n("is_primary",s.target.checked),color:"primary"}),label:"Set sebagai alamat utama"}),t.jsxs(f,{direction:"row",spacing:2,sx:{pt:2},children:[t.jsx(g,{type:"submit",variant:"contained",disabled:l,sx:{flex:1,py:1.5,borderRadius:2,fontWeight:600},children:l?"Menyimpan...":r?"Update Alamat":"Tambah Alamat"}),t.jsx(g,{variant:"outlined",onClick:a,disabled:l,sx:{flex:1,py:1.5,borderRadius:2,fontWeight:600},children:"Batal"})]})]})]})}export{B as A,q as u};
