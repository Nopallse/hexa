import{a as P,ar as C,r as s,j as t,C as S,$ as p,a0 as B,aq as v,T as c,B as w}from"./index-BNHkdQXN.js";import{p as l}from"./productApi-DD1g0Rr2.js";import{c as F}from"./categoryApi-BM3YVwSW.js";import{P as I}from"./ProductForm-DBok1RYX.js";import{B as E}from"./Breadcrumbs-CE1cFXMC.js";import"./schemas-B-_fRkL-.js";import"./ProductVariantManager-BJ7JxAdk.js";import"./CardContent-Xxy-Rqsq.js";import"./Alert-CGwzUP-j.js";import"./Add-AYyC_BLZ.js";import"./Delete-C5OGYaUx.js";import"./Tooltip-B_Lp-BkP.js";import"./CloudUpload-salt8l8H.js";import"./TableRow-B4eIPwcd.js";import"./Image-DAvnxpNy.js";import"./Edit-jAiCsqyQ.js";import"./DialogTitle-CzRdnrxR.js";import"./DialogActions-Bz3wEnKU.js";import"./image-CL12PwSa.js";import"./ProductImageManager-DTqaUGxC.js";import"./Star-CXrkLN9S.js";import"./CardMedia-ZAZUzI8i.js";import"./FormControlLabel-D-UURHDS.js";import"./Switch-ij0PE0FT.js";function ta(){const o=P(),{showNotification:i}=C(),[u,g]=s.useState([]),[h,m]=s.useState(!1),[b,n]=s.useState(null),f=async()=>{try{const a=await F.getCategories();a.success&&g(a.data)}catch(a){console.error("Failed to fetch categories:",a),n("Gagal memuat data kategori")}};s.useEffect(()=>{f()},[]);const x=async a=>{try{m(!0),n(null);const e=a._imageFiles||[],k={category_id:a.category_id,name:a.name,description:a.description,price:a.price,stock:a.stock},d=await l.createProduct(k);if(!d.success)throw new Error("Failed to create product");const j=d.data.id;if(e.length>0)try{for(let r=0;r<e.length;r++)await l.createProductImage(j,{image_name:"",is_primary:r===0,_imageFile:e[r]});i({type:"success",message:`Produk berhasil ditambahkan dengan ${e.length} gambar`})}catch(r){console.error("Failed to upload images:",r),i({type:"warning",message:"Produk berhasil dibuat, tapi gagal upload beberapa gambar. Silakan upload manual."})}else i({type:"success",message:"Produk berhasil ditambahkan"});o("/admin/products")}catch(e){n(e.message||"Gagal menambahkan produk")}finally{m(!1)}},y=()=>{o("/admin/products")};return t.jsxs(S,{maxWidth:!1,children:[t.jsxs(E,{sx:{mb:3},children:[t.jsxs(p,{component:"button",variant:"body2",onClick:()=>o("/admin"),sx:{display:"flex",alignItems:"center",gap:.5},children:[t.jsx(B,{fontSize:"small"}),"Dashboard"]}),t.jsxs(p,{component:"button",variant:"body2",onClick:()=>o("/admin/products"),sx:{display:"flex",alignItems:"center",gap:.5},children:[t.jsx(v,{fontSize:"small"}),"Produk"]}),t.jsx(c,{variant:"body2",color:"textPrimary",children:"Tambah Baru"})]}),t.jsxs(w,{sx:{mb:4},children:[t.jsx(c,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Tambah Produk Baru"}),t.jsx(c,{variant:"body1",color:"textSecondary",children:"Buat produk baru untuk toko Anda"})]}),t.jsx(I,{mode:"create",categories:u,isLoading:h,error:b,onSubmit:x,onCancel:y})]})}export{ta as default};
