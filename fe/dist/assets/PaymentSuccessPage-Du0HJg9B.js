import{p as P,q as S,aj as D,a2 as W,r as i,j as e,B as r,T as a,C as p,t as m,S as y}from"./index-CZFAEO2y.js";import{o as w}from"./orderApi-BZ9ScYhU.js";import{u as A}from"./useCurrencyConversion-BCvfb8ro.js";import{A as g}from"./Alert-Dhgb7HXh.js";import{H as b}from"./Home-DOPYlfgE.js";import{C as B}from"./CheckCircle-BNdM5O0E.js";import{C as L,a as _}from"./CardContent-CEZafFSD.js";import{O as E}from"./Receipt-D4oLEU22.js";import"./useSlot-CExgq9at.js";function q(){P();const x=S(),h=D(),[u]=W(),{formatPrice:v}=A(),o=u.get("order_id"),d=h.state?.orderId,t=o||d,[n,I]=i.useState(null),[k,c]=i.useState(!0),[f,l]=i.useState(null),C=async()=>{if(console.log("PaymentSuccessPage - Order ID Debug:",{orderIdFromUrl:o,orderIdFromState:d,finalOrderId:t,locationState:h.state,searchParams:Object.fromEntries(u.entries())}),!t){l("Order ID tidak ditemukan dalam URL atau state"),c(!1);return}try{c(!0),console.log("Fetching order with ID:",t);const s=await w.getOrderById(t);s.success?I(s.data):l("Order tidak ditemukan di server")}catch(s){console.error("Error fetching order:",s),l(s.response?.data?.error||"Gagal memuat order")}finally{c(!1)}};i.useEffect(()=>{C()},[t]);const O=()=>{t&&x(`/orders/${t}`)},j=()=>{x("/")};return k?e.jsx(r,{sx:{minHeight:"100vh",py:8,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(a,{children:"Memuat..."})}):f||!n?e.jsx(r,{sx:{minHeight:"100vh",py:8},children:e.jsxs(p,{maxWidth:"md",children:[e.jsx(g,{severity:"error",sx:{maxWidth:600,mx:"auto"},children:f||"Order tidak ditemukan"}),e.jsx(r,{sx:{mt:2,p:2,backgroundColor:"#f5f5f5",borderRadius:1},children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Debug Info:"}),e.jsx("br",{}),"Order ID from URL: ",o||"null",e.jsx("br",{}),"Order ID from State: ",d||"null",e.jsx("br",{}),"Final Order ID: ",t||"null"]})}),e.jsx(r,{sx:{textAlign:"center",mt:4},children:e.jsx(m,{variant:"contained",onClick:j,startIcon:e.jsx(b,{}),children:"Kembali ke Beranda"})})]})}):e.jsx(r,{sx:{minHeight:"100vh",py:8},children:e.jsxs(p,{maxWidth:"md",children:[e.jsxs(r,{sx:{textAlign:"center",mb:6},children:[e.jsx(B,{sx:{fontSize:80,color:"success.main",mb:3,animation:"pulse 2s infinite","@keyframes pulse":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(1.05)"},"100%":{transform:"scale(1)"}}}}),e.jsx(a,{variant:"h3",fontWeight:700,color:"success.main",sx:{mb:2},children:"Pembayaran Berhasil!"}),e.jsx(a,{variant:"h6",color:"text.secondary",children:"Terima kasih atas pembelian Anda. Pesanan Anda sedang diproses."})]}),e.jsx(L,{sx:{mb:4},children:e.jsxs(_,{sx:{p:4},children:[e.jsx(a,{variant:"h6",fontWeight:600,sx:{mb:3},children:"Detail Pesanan"}),e.jsxs(y,{spacing:2,children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Order ID:"}),e.jsx(a,{variant:"body1",fontWeight:500,children:n.id})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Total Pembayaran:"}),e.jsx(a,{variant:"h6",fontWeight:600,color:"primary.main",children:v(Number(n.total_amount)+Number(n.shipping_cost))})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Status:"}),e.jsx(a,{variant:"body1",fontWeight:500,color:n.payment_status==="paid"?"success.main":"warning.main",children:n.payment_status==="paid"?"Lunas":n.payment_status})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",children:"Tanggal Pesanan:"}),e.jsx(a,{variant:"body1",fontWeight:500,children:new Date(n.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})}),e.jsx(g,{severity:"info",sx:{mb:4},children:e.jsx(a,{variant:"body2",children:'Kami akan mengirimkan email konfirmasi dan detail pengiriman ke alamat email Anda. Anda juga dapat melacak status pesanan di halaman "Pesanan Saya".'})}),e.jsxs(y,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"center",children:[e.jsx(m,{variant:"contained",size:"large",startIcon:e.jsx(E,{}),onClick:O,sx:{px:4,py:1.5,borderRadius:2,fontWeight:600},children:"Lihat Detail Pesanan"}),e.jsx(m,{variant:"outlined",size:"large",startIcon:e.jsx(b,{}),onClick:j,sx:{px:4,py:1.5,borderRadius:2,fontWeight:600},children:"Kembali ke Beranda"})]})]})})}export{q as default};
