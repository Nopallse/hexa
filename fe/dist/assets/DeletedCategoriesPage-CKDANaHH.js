import{q as W,aB as $,r,j as e,ag as F,C as G,an as C,w,T as i,B as l,v as P,D as H,K as N,Y as z,y as U,I as _,A as S}from"./index-tvCmUXkA.js";import{g as q}from"./image-CeHRN-zl.js";import{B as M}from"./Breadcrumbs-BRY0wQO3.js";import{H as O}from"./Home-FYrVyE1n.js";import{R as Y}from"./Refresh-RespFlYJ.js";import{A as J}from"./Alert-iJ2nvuQL.js";import{T as Q,a as V,b as X,c as f,d as s,e as Z}from"./TableRow-Bx2Iwbxr.js";import{A as ee}from"./Avatar-Cw6JEpzV.js";import{T as ae}from"./Tooltip-CRdXSvuP.js";import{R as se}from"./Restore-CEq2gqFD.js";import{T as te}from"./TablePagination-BcG9v-ci.js";import"./useSlot-Dd61XFNI.js";import"./Popper-DMWFBkOI.js";import"./KeyboardArrowRight-GxyP2UjW.js";import"./LastPage-Unmxpdhm.js";function ye(){const d=W(),{showNotification:y}=$(),[c,T]=r.useState([]),[h,b]=r.useState(!0),[k,g]=r.useState(null),[n,D]=r.useState(""),[m,x]=r.useState(0),[p,I]=r.useState(10),[v,R]=r.useState(0),u=async a=>{try{b(!0),g(null);const t=await S.getDeletedCategories({page:(m||0)+1,limit:p,search:n||void 0,...a});if(t.success)T(t.data),R(t.pagination?.total||0);else throw new Error("Failed to fetch deleted categories")}catch(t){g(t.message||"Gagal memuat data kategori yang dihapus")}finally{b(!1)}};r.useEffect(()=>{u()},[m,p,n]);const A=async(a,t)=>{if(window.confirm(`Apakah Anda yakin ingin memulihkan kategori "${t}"?`))try{const o=await S.restoreCategory(a);if(o.success)y({type:"success",message:"Kategori berhasil dipulihkan"}),await u();else throw new Error(o.message||"Failed to restore category")}catch(o){y({type:"error",message:o.message||"Gagal memulihkan kategori"})}},B=a=>{D(a.target.value),x(0)},K=(a,t)=>{x(t)},E=a=>{I(parseInt(a.target.value,10)),x(0)},L=()=>{u()};return h&&c.length===0?e.jsx(F,{message:"Memuat data kategori yang dihapus..."}):e.jsxs(G,{maxWidth:!1,children:[e.jsxs(M,{sx:{mb:3},children:[e.jsxs(C,{component:"button",variant:"body2",onClick:()=>d("/admin"),sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(O,{fontSize:"small"}),"Dashboard"]}),e.jsxs(C,{component:"button",variant:"body2",onClick:()=>d("/admin/categories"),sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(w,{fontSize:"small"}),"Kategori"]}),e.jsx(i,{variant:"body2",color:"textPrimary",children:"Kategori Dihapus"})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(l,{children:[e.jsx(i,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Kategori yang Dihapus"}),e.jsx(i,{variant:"body1",color:"textSecondary",children:"Kelola kategori yang telah dihapus (soft delete)"})]}),e.jsxs(l,{sx:{display:"flex",gap:2},children:[e.jsx(P,{variant:"outlined",startIcon:e.jsx(Y,{}),onClick:L,disabled:h,children:"Refresh"}),e.jsx(P,{variant:"outlined",onClick:()=>d("/admin/categories"),children:"Kembali ke Kategori"})]})]}),e.jsx(l,{sx:{mb:3},children:e.jsx(H,{fullWidth:!0,placeholder:"Cari kategori yang dihapus...",value:n,onChange:B,InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(z,{})})},sx:{maxWidth:400}})}),k&&e.jsx(J,{severity:"error",sx:{mb:3},onClose:()=>g(null),children:k}),e.jsx(Q,{component:U,children:e.jsxs(V,{children:[e.jsx(X,{children:e.jsxs(f,{children:[e.jsx(s,{width:"80",children:"Gambar"}),e.jsx(s,{children:"Nama Kategori"}),e.jsx(s,{children:"Deskripsi"}),e.jsx(s,{children:"Dibuat"}),e.jsx(s,{children:"Dihapus"}),e.jsx(s,{align:"center",children:"Aksi"})]})}),e.jsx(Z,{children:c.length===0?e.jsx(f,{children:e.jsx(s,{colSpan:6,align:"center",sx:{py:4},children:e.jsx(i,{variant:"body1",color:"textSecondary",children:n?"Tidak ada kategori yang dihapus sesuai pencarian":"Tidak ada kategori yang dihapus"})})}):c.map(a=>e.jsxs(f,{hover:!0,children:[e.jsx(s,{children:e.jsx(ee,{src:q(a.image),alt:a.name,variant:"rounded",sx:{width:56,height:56},children:e.jsx(w,{})})}),e.jsx(s,{children:e.jsx(i,{variant:"body1",fontWeight:"medium",children:a.name})}),e.jsx(s,{children:e.jsx(i,{variant:"body2",color:"textSecondary",children:a.description||"-"})}),e.jsx(s,{children:e.jsx(i,{variant:"body2",children:new Date(a.created_at).toLocaleDateString("id-ID")})}),e.jsx(s,{children:e.jsx(i,{variant:"body2",color:"error",children:new Date(a.deleted_at).toLocaleDateString("id-ID")})}),e.jsx(s,{align:"center",children:e.jsx(ae,{title:"Pulihkan Kategori",children:e.jsx(_,{color:"primary",onClick:()=>A(a.id,a.name),disabled:h,children:e.jsx(se,{})})})})]},a.id))})]})}),v>0&&e.jsx(te,{rowsPerPageOptions:[5,10,25,50],component:"div",count:v,rowsPerPage:p,page:m,onPageChange:K,onRowsPerPageChange:E,labelRowsPerPage:"Baris per halaman:",labelDisplayedRows:({from:a,to:t,count:j})=>`${a}-${t} dari ${j!==-1?j:`lebih dari ${t}`}`})]})}export{ye as default};
